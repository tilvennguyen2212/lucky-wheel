(globalThis.webpackChunklucky_wheel=globalThis.webpackChunklucky_wheel||[]).push([["src_bootstrap_app_tsx-src_static_sound_fail_mp3-src_static_sound_sound_mp3-src_static_sound_w-1e4732"],{98463:(e,t,a)=>{"use strict";a.r(t),a.d(t,{ReactComponent:()=>p,default:()=>h});var n,r,s,i,l,c,o=a(92950);function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},d.apply(this,arguments)}function u(e,t){let{title:a,titleId:u,...p}=e;return o.createElement("svg",d({width:96,height:96,viewBox:"0 0 96 96",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":u},p),a?o.createElement("title",{id:u},a):null,n||(n=o.createElement("rect",{width:96,height:96,rx:24,fill:"url(#paint0_linear_3166_6054)"})),r||(r=o.createElement("path",{opacity:.5,d:"M33.2491 48C33.2491 45.1293 34.0891 42.4482 35.5235 40.1533C35.7811 39.7413 35.7373 39.2022 35.3937 38.8586L23.7776 27.2425C23.3676 26.8324 22.6947 26.8552 22.3289 27.3052C17.7288 32.9639 15 40.1671 15 48C15 55.8311 17.7276 63.0328 22.2972 68.6909C22.662 69.1427 23.336 69.167 23.7471 68.7569L35.3922 57.1413C35.7366 56.7978 35.7807 56.2582 35.523 55.8457C34.0888 53.551 33.2491 50.8703 33.2491 48Z",fill:"#212433"})),s||(s=o.createElement("path",{d:"M48.0993 33.1501C50.97 33.1501 53.651 33.9901 55.9459 35.4245C56.358 35.6821 56.8971 35.6383 57.2407 35.2947L68.7599 23.7755C69.1692 23.3662 69.1475 22.6949 68.6993 22.3287C63.0691 17.7287 55.8645 15 48.0003 15C40.1692 15 32.9976 17.7275 27.3423 22.297C26.8906 22.662 26.8663 23.336 27.2763 23.7471L38.8535 35.3537C39.1994 35.7005 39.7437 35.7426 40.157 35.4797C42.457 34.0165 45.1698 33.1501 48.0993 33.1501Z",fill:"#212433"})),i||(i=o.createElement("path",{opacity:.5,d:"M73.3619 26.9267C73.1758 26.7039 72.8391 26.6915 72.6335 26.8965L60.4447 39.0541C60.2713 39.2271 60.2495 39.4997 60.3866 39.7026C61.9902 42.0764 62.9491 44.9184 62.9491 48C62.9491 51.0819 61.9901 53.924 60.3862 56.298C60.2493 56.5007 60.2709 56.773 60.4439 56.946L72.6335 69.1356C72.839 69.3411 73.1761 69.3289 73.3623 69.1058C78.1367 63.3869 81.0001 56.0238 81.0001 48C81.0001 39.976 78.1365 32.6443 73.3619 26.9267Z",fill:"#212433"})),l||(l=o.createElement("path",{d:"M48.0991 62.8499C45.0172 62.8499 42.1751 61.8909 39.8012 60.2871C39.5984 60.1502 39.3262 60.1718 39.1532 60.3448L26.8645 72.6334C26.6591 72.8389 26.6712 73.176 26.8943 73.3622C32.6133 78.1366 39.9763 81 48.0001 81C56.0572 81 63.4219 78.1358 69.1104 73.3295C69.3315 73.1427 69.3426 72.8074 69.1379 72.6027L56.9433 60.4081C56.7715 60.2363 56.5015 60.2136 56.2991 60.3479C53.9279 61.9207 51.1184 62.8499 48.0991 62.8499Z",fill:"#212433"})),c||(c=o.createElement("defs",null,o.createElement("linearGradient",{id:"paint0_linear_3166_6054",x1:0,y1:96,x2:104.62,y2:85.4464,gradientUnits:"userSpaceOnUse"},o.createElement("stop",{stopColor:"#9945FF"}),o.createElement("stop",{offset:1,stopColor:"#B9F8FD"})))))}const p=o.forwardRef(u),h=a.p+"static/media/logo.c646f6444e0d9e3a8fd446c4798713e5.svg"},45597:(e,t,a)=>{"use strict";Object.defineProperty(t,"X$",{value:!0}),Object.defineProperty(t,"jY",{enumerable:!0,get:function(){return i.default}}),t.h0=void 0,Object.defineProperty(t,"ng",{enumerable:!0,get:function(){return l.default}});var n=c(a(27803)),r=c(a(85468)),s=c(a(83943)),i=c(a(98463)),l=c(a(83272));function c(e){return e&&e.__esModule?e:{default:e}}const o=[n.default,r.default,s.default];t.h0=o},22669:(e,t,a)=>{"use strict";a.r(t),a.d(t,{Page:()=>$n,__esModule:()=>Gn.X$,logo:()=>Gn.jY,panels:()=>Gn.h0,readme:()=>Gn.ng});var n=a(92950),r=a(55754),s=a(18863),i=a(45055),l=a(32671),c=a(4848),o=a.n(c),d=a(33804);const u=(e,t)=>window.notify({type:"success",description:`${e} successfully. Click to view details.`,onClick:()=>window.open(s.util.explorer(t),"_blank")}),p=e=>window.notify({type:"error",description:e.message});var h=a(45263);const w=e=>{let{campaignAddress:t}=e;const[a,r]=(0,n.useState)(""),[s,i]=(0,n.useState)(!1),[c,o]=(0,n.useState)(!1);return(0,h.jsx)(l.Popover,{content:(0,h.jsx)(l.Collapse,{defaultActiveKey:["1"],children:(0,h.jsx)(l.Collapse.Panel,{header:"Print Ticket",children:(0,h.jsxs)(l.Row,{gutter:[12,12],justify:"space-between",children:[(0,h.jsx)(l.Col,{children:(0,h.jsx)(l.Typography.Text,{children:"Total Amount:"})}),(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(l.InputNumber,{value:a,onChange:r,min:"0",style:{width:"100%"}})}),(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(l.Button,{onClick:async()=>{try{o(!0);const{txId:e}=await window.luckyWheel.printTicketMint({campaign:new d.web3.PublicKey(t),amount:new d.BN(a)});u("Print ticket",e)}catch(e){p(e)}finally{o(!1)}},loading:c,block:!0,type:"primary",children:"Print"})})]})},"1")}),trigger:"click",visible:s,onVisibleChange:i,placement:"bottomLeft",children:(0,h.jsx)(l.Button,{onClick:()=>i(!0),children:"Print Ticket"},"2")})};const y={appId:"lucky_wheel",url:"https://descartesnetwork.github.io/sen-lucky-wheel/index.js"},m={development:{...y},production:{...y}},x={devnet:{node:"https://api.devnet.solana.com",programId:"38k8ejgfKJ2VKRApCMkev1hQwqobTTZPLnX11t2dxAXA",campaignId:"5FRpZG9dxomxZaBuYSAjicHABoZVKEyk8ggiax79c4aV"},testnet:{node:"https://api.testnet.solana.com",programId:"2L1eKz8TA88j84yoAywGdeKF1ohvjQC4iMxzR5GbjkWD",campaignId:"CMaVCUKcxf2qHNhvcnLUEmpXWs9aZWB4xp5nYACj6a2g"},mainnet:{node:"https://api.mainnet-beta.solana.com",programId:"3sFeMcoZbqRJVVZpv2jvK6zfDopJ48B2vxzTBsHPoSJ7",campaignId:"6o6qwGH8WzntHBg5rf64zPUQJKGr7WtGgBhhfhEwpHj8"}},g=e=>({origin:e,lottery:{index:e+"/lottery",get publicKey(){return this.index+"/util/lottery-pubkey"},get luckyNumber(){return this.index+"/lucky-number/"}}}),j={development:{...g("https://api.sentre.io")},production:{...g("https://api.sentre.io")}},C={manifest:m[s.env],sol:x[s.net],api:j[s.env]};var f=a(19289);let b;!function(e){e.Token="token",e.NFT="nft",e.GoodLuck="good-luck",e.Ticket="ticket"}(b||(b={}));const k=["radial-gradient(47.41% 47.41% at 49.98% 50.04%, #8952CC 10.07%, #B67AFF 58.27%, #D2ADFF 85.66%, #C799FF 92.66%, #AF76F5 100%)","radial-gradient(47.41% 47.41% at 49.98% 50.04%, #52C4CC 10.07%, #7AF6FF 58.27%, #B3FAFF 85.66%, #85F7FF 92.66%, #53DCE6 100%)","radial-gradient(47.41% 47.41% at 49.98% 50.04%, #415FCC 10.07%, #708FFF 58.27%, #A3B7FF 85.66%, #99AFFF 92.66%, #6987F0 100%)"];let T,v;!function(e){e.Spin="spin",e.Reward="reward",e.Challenge="challenge",e.LeaderBoard="leaderboard"}(T||(T={})),function(e){e.Claimed="CLAIMED",e.Ready="CLAIM",e.Pending="SPIN MORE"}(v||(v={}));const A="11111111111111111111111111111111";let S;!function(e){e.Token="Token",e.NFT="NFT",e.Ticket="Ticket"}(S||(S={}));const R={gravity:.5,opacity:1,zIndex:9999,numberOfPieces:200},N={gravity:.1,opacity:.3,zIndex:"unset",numberOfPieces:75},P="main",B={campaign:"",confetti:N,tabId:T.Spin},I=(0,f.createAsyncThunk)("main/setCampaign",(async e=>{let{campaign:t}=e;return{campaign:t}})),F=(0,f.createAsyncThunk)("main/setConfetti",(async e=>{let{confetti:t}=e;return{confetti:t}})),z=(0,f.createAsyncThunk)("main/setTabId",(async e=>{let{tabId:t}=e;return{tabId:t}})),L=(0,f.createSlice)({name:P,initialState:B,reducers:{},extraReducers:e=>{e.addCase(I.fulfilled,((e,t)=>{let{payload:a}=t;Object.assign(e,a)})).addCase(F.fulfilled,((e,t)=>{let{payload:a}=t;Object.assign(e,a)})).addCase(z.fulfilled,((e,t)=>{let{payload:a}=t;Object.assign(e,a)}))}}).reducer,M=()=>{const e=(0,r.useSelector)((e=>e.main.campaign)),t=(0,r.useSelector)((e=>e.campaigns)),a=(0,r.useDispatch)();return(0,n.useEffect)((()=>{!t[e]&&Object.keys(t).length&&a(I({campaign:Object.keys(t)[0]})),e||a(I({campaign:C.sol.campaignId}))}),[t,a,e]),e};var E=a(21995),D=a.n(E),O=a(97429).Buffer;const W=()=>{const[e,t]=(0,n.useState)(!1),[a,r]=(0,n.useState)(""),{onInitializeCampaign:s,loading:i}=(()=>{const[e,t]=(0,n.useState)(!1);return{onInitializeCampaign:(0,n.useCallback)((async e=>{t(!0);try{const{txId:a}=await window.luckyWheel.initializeCampaign({picker:e,startDate:new d.BN(0),endDate:new d.BN(0)});u("Create campaign",a)}catch(a){p(a)}finally{t(!1)}}),[]),loading:e}})();return(0,h.jsxs)(n.Fragment,{children:[(0,h.jsx)(l.Button,{type:"primary",onClick:()=>t(!0),children:"Create Campaign Now"}),(0,h.jsx)(l.Modal,{title:"Create Campaign",visible:e,onCancel:()=>t(!1),onOk:()=>{s(Array.from(O.from(a,"hex")))},okText:"Create",confirmLoading:i,children:(0,h.jsxs)(l.Row,{gutter:[12,12],justify:"space-between",children:[(0,h.jsx)(l.Col,{children:(0,h.jsx)(l.Typography.Text,{children:"Picker (Hex):"})}),(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(l.Input,{value:a,onChange:e=>r(e.target.value),style:{width:"100%"}})}),(0,h.jsx)(l.Col,{span:12,children:(0,h.jsx)(l.Button,{type:"primary",block:!0,onClick:async()=>{const{data:e}=await D().get(C.api.lottery.publicKey,{withCredentials:!0}),t=await window.luckyWheel.decodePickerPublickey(e);r(O.from(t).toString("hex"))},children:"Sentre Picker"})}),(0,h.jsx)(l.Col,{span:12,children:(0,h.jsx)(l.Button,{type:"primary",block:!0,onClick:async()=>{const e=Array.from(window.luckyWheel.picker.pubKey);r(O.from(e.slice(1,65)).toString("hex"))},children:"Default Picker"})})]})})]})};var K=a(97429).Buffer;const Z=e=>{let{campaignAddress:t}=e;const[a,r]=(0,n.useState)(""),[i,c]=(0,n.useState)(!1),[o,d]=(0,n.useState)(!1),w=(0,s.useWalletAddress)();return(0,h.jsxs)(n.Fragment,{children:[(0,h.jsx)(l.Button,{type:"primary",onClick:()=>c(!0),children:"Update Picker"}),(0,h.jsx)(l.Modal,{title:"Create Campaign",visible:i,onCancel:()=>c(!1),onOk:async()=>{try{d(!0);const e=await window.luckyWheel.program.methods.updatePicker(Array.from(K.from(a,"hex"))).accounts({authority:w,campaign:t}).rpc();u("Update picker",e)}catch(e){p(e)}finally{d(!1)}},okText:"Update",confirmLoading:o,children:(0,h.jsxs)(l.Row,{gutter:[12,12],justify:"space-between",children:[(0,h.jsx)(l.Col,{children:(0,h.jsx)(l.Typography.Text,{children:"Picker (Hex):"})}),(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(l.Input,{value:a,onChange:e=>r(e.target.value),style:{width:"100%"}})}),(0,h.jsx)(l.Col,{span:12,children:(0,h.jsx)(l.Button,{type:"primary",block:!0,onClick:async()=>{const{data:e}=await D().get(C.api.lottery.publicKey,{withCredentials:!0}),t=await window.luckyWheel.decodePickerPublickey(e);r(K.from(t).toString("hex"))},children:"Sentre Picker"})}),(0,h.jsx)(l.Col,{span:12,children:(0,h.jsx)(l.Button,{type:"primary",block:!0,onClick:async()=>{const e=Array.from(window.luckyWheel.picker.pubKey);r(K.from(e.slice(1,65)).toString("hex"))},children:"Default Picker"})})]})})]})},_=e=>{const{accountClient:t}=(0,n.useMemo)((()=>{const e=window.luckyWheel.program.account.ticket;return{accountClient:e,connection:e.provider.connection}}),[]);return{getTickets:(0,n.useCallback)((async()=>{try{const a=await t.all([{memcmp:{bytes:e,offset:8}}]),n={};for(const e of a)n[e.publicKey.toBase58()]=e.account;return n}catch(a){return{}}}),[t,e])}},H=e=>{const t=(0,r.useSelector)((e=>e.rewards));return(0,n.useMemo)((()=>{const a={};for(const n in t){const{campaign:r}=t[n];r.toBase58()===e&&(a[n]=t[n])}return a}),[t,e])},V=e=>{const{getTickets:t}=_(e),a=H(e),r=(0,n.useCallback)((async()=>{const e=await t();let n={};for(const t in e){const{state:r,reward:s,authority:i}=e[t],l=a[s.toBase58()];if(!r.claimed&&!r.won||!l||!l.rewardType.token)continue;const c=(n[i.toBase58()]||{})[l.mint.toBase58()]||new d.BN(0),o=l.prizeAmount;n[i.toBase58()]=Object.assign({...n[i.toBase58()]},{[l.mint.toBase58()]:c.add(o)})}return n}),[t,a]);return{getPrizeAmountTickets:r}};var Y=a(97429).Buffer;const G=()=>{const e=(0,r.useSelector)((e=>e.campaigns)),[t,a]=(0,n.useState)(""),[i,c]=(0,n.useState)(0),[o,u]=(0,n.useState)(0),p=(0,s.useWalletAddress)(),y=M(),{to:m}=(0,s.useAppRoute)(C.manifest.appId),x=(0,s.useGetMintData)(),g=(0,r.useDispatch)(),{getPrizeAmountTickets:j}=V(y),f=e[y],b=t=>{var a;return p===(null===(a=e[t])||void 0===a?void 0:a.authority.toBase58())},k=(0,n.useCallback)((async()=>{const e=(await window.luckyWheel.deriveCampaignPDAs(new d.web3.PublicKey(y))).ticketMint.toBase58();let t=0;try{const a=await x({mintAddress:e});void 0!==a&&(t=Number(a[e].supply.toString()))}catch(n){}return u(t),a(e)}),[x,y]);return(0,n.useEffect)((()=>{k()}),[k]),(0,n.useEffect)((()=>{(async()=>{const e=await j();e&&c(Object.keys(e).length)})()}),[j]),(0,h.jsx)(l.PageHeader,{ghost:!1,onBack:()=>m("/dashboard"),title:"Admin",subTitle:(0,h.jsxs)(l.Space,{children:[y,b(y)?(0,h.jsx)(l.Tag,{color:"success",children:"Your Campaign"}):(0,h.jsx)(l.Tag,{color:"error",children:"Not Have Permission"})]}),style:{backgroundColor:"rgba(255, 255, 255, 0.1)"},extra:[(0,h.jsx)(l.Select,{style:{width:120},onChange:e=>g(I({campaign:e})),value:y,children:Object.keys(e).map((e=>(0,h.jsx)(l.Select.Option,{value:e,children:(0,h.jsx)(l.Typography.Text,{style:{color:b(e)?void 0:"red"},children:e})},e)))},"3"),(0,h.jsx)(w,{campaignAddress:y},"PrintTicket"),(0,h.jsx)(Z,{campaignAddress:y},"UpdatePicker"),(0,h.jsx)(W,{},"CreateCampaign")],children:(0,h.jsxs)(l.Row,{gutter:[24,24],style:{paddingLeft:32},children:[(0,h.jsx)(l.Col,{span:17,children:(0,h.jsxs)(l.Descriptions,{size:"small",column:2,children:[(0,h.jsx)(l.Descriptions.Item,{label:"Address",children:y}),(0,h.jsx)(l.Descriptions.Item,{label:"Ticket Token",children:t}),(0,h.jsx)(l.Descriptions.Item,{label:"Authority",children:s.util.shortenAddress((null===f||void 0===f?void 0:f.authority.toBase58())||"",8)}),(0,h.jsx)(l.Descriptions.Item,{label:"Picker",children:s.util.shortenAddress(Y.from((null===f||void 0===f?void 0:f.picker)||[]).toString("hex"),8)})]})}),(0,h.jsx)(l.Col,{span:"auto",children:(0,h.jsxs)(l.Space,{size:32,children:[(0,h.jsx)(l.Statistic,{title:"Total Ticket",value:null===f||void 0===f?void 0:f.totalTicket.toNumber()}),(0,h.jsx)(l.Statistic,{title:"Total Picked",value:null===f||void 0===f?void 0:f.totalPicked.toNumber()}),(0,h.jsx)(l.Statistic,{title:"Total Ticket Mint",value:o}),(0,h.jsx)(l.Statistic,{title:"Total user",value:i})]})})]})})},U=e=>(0,r.useSelector)((t=>t.rewards[e])),$=e=>{let{rewardAddress:t}=e;const a=U(t);let n=0;return a&&(n=Number(a.toLuckyNumber.sub(a.fromLuckyNumber))/10**18),(0,h.jsx)("span",{children:s.util.numeric(n).format("0,0.[0000]%")})};var J=a(6109);const q=e=>(0,r.useSelector)((t=>t.challengeRewards[e])),X=e=>{let{rewardAddress:t,isChallenge:a=!1}=e;const n=q(t),r=U(t),s=a?n:r,i=a?null===n||void 0===n?void 0:n.amount:null===r||void 0===r?void 0:r.prizeAmount;return null!==s&&void 0!==s&&s.rewardType&&t!==A?s.rewardType.nftCollection?(0,h.jsx)("span",{children:"1"}):s.rewardType.ticket?(0,h.jsx)("span",{children:i.toNumber()}):(0,h.jsx)(J.Z,{mintAddress:s.mint,amount:i,formatter:"0,0.[00]a"}):null};var Q=a(74939);const ee=a.p+"static/media/good-luck-icon.b0914abdc9cae6b01db6.png",te=a.p+"static/media/ticket-icon.addffd5f07fb7f68f0f0.png",ae=e=>{let{rewardAddress:t,size:a,isChallenge:n=!1}=e;const r=U(t),s=q(t),i=n?s:r;return null!==i&&void 0!==i&&i.rewardType&&t!==A?i.rewardType.ticket?(0,h.jsx)(l.Avatar,{size:a,src:te,shape:"square"}):(0,h.jsx)(Q.Z,{mintAddress:i.mint,size:a}):(0,h.jsx)(l.Avatar,{size:a,shape:"circle",src:ee})};var ne=a(63396),re=a(99370);const se=e=>{let{rewardAddress:t,isChallenge:a=!1}=e;const n=U(t)||{mint:new d.web3.PublicKey(A)},r=q(t),s=a?r:n;return null!==s&&void 0!==s&&s.rewardType&&t!==A?s.rewardType.ticket?(0,h.jsx)("span",{children:"Ticket"}):s.rewardType.nftCollection?(0,h.jsx)(ne.Z,{mintAddress:s.mint}):(0,h.jsx)(re.Z,{mintAddress:s.mint}):(0,h.jsxs)("span",{children:["So ",(0,h.jsx)("br",{})," Close!"]})};var ie=a(69716),le=a(95418);const ce="rewards",oe=(0,f.createAsyncThunk)("rewards/initRewards",(async e=>e)),de=(0,f.createAsyncThunk)("rewards/upsetReward",(async e=>{let{address:t,data:a}=e;if(!le.account.isAddress(t))throw new Error("Invalid reward address");if(!a)throw new Error("Data is empty");return{[t]:a}})),ue=(0,f.createAsyncThunk)("rewards/getReward",(async(e,t)=>{let{address:a}=e,{getState:n}=t;const{rewards:{[a]:r}}=n();return{[a]:r}})),pe=(0,f.createSlice)({name:ce,initialState:{},reducers:{},extraReducers:e=>{e.addCase(oe.fulfilled,((e,t)=>{let{payload:a}=t;return a})).addCase(de.fulfilled,((e,t)=>{let{payload:a}=t;Object.assign(e,a)}))}}).reducer,he=()=>{const[e,t]=(0,n.useState)(!1),a=(0,r.useDispatch)();return{withdrawReward:async e=>{let{totalPrize:n,reward:r,mint:s}=e;t(!0);const{[r]:i}=await a(ue({address:r})).unwrap();try{const{txId:e}=await window.luckyWheel.withdrawReward({campaign:i.campaign,reward:new d.web3.PublicKey(r),totalPrize:new d.BN(n),mint:new d.web3.PublicKey(s)});u("Withdraw reward",e)}catch(l){p(l)}finally{t(!1)}},loading:e}},we=e=>{let{rewardAddress:t}=e;const[a,r]=(0,n.useState)("0"),s=U(t),{withdrawReward:i,loading:c}=he();return(0,h.jsxs)(l.Row,{gutter:[12,12],justify:"space-between",children:[(0,h.jsx)(l.Col,{children:(0,h.jsx)(l.Typography.Text,{children:"Total Prize:"})}),(0,h.jsx)(l.Col,{span:"auto",children:(0,h.jsx)(l.Space,{children:(0,h.jsxs)(l.Typography.Text,{type:"secondary",style:{cursor:"pointer"},onClick:()=>r(s.reservePrize.toString()),children:["Available: ",s.reservePrize.toNumber()]})})}),(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(l.InputNumber,{value:a,onChange:r,min:"0",style:{width:"100%"}})}),(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(l.Button,{onClick:async()=>{await i({totalPrize:Number(a),mint:s.mint.toBase58(),reward:t})},block:!0,type:"primary",loading:c,children:"Withdraw"})})]})},ye=e=>{let{rewardAddress:t}=e;const{withdrawReward:a}=he(),i=(()=>{const e=(0,r.useDispatch)(),t=(0,n.useCallback)((async t=>{const a=t.toString(),{[a]:n}=await e(ue({address:a})).unwrap(),{rewardTreasurer:r}=await window.luckyWheel.deriveRewardPDAs(new d.web3.PublicKey(t),n.mint),{value:i}=await s.splt.connection.getTokenAccountsByOwner(r,{programId:s.splt.spltProgramId});return i.map((e=>s.splt.parseAccountData(e.account.data))).filter((e=>Number(e.amount.toString())>0))}),[e]);return t})();return(0,h.jsx)(l.Button,{onClick:async()=>{const e=await i(t);await a({totalPrize:1,mint:e[0].mint,reward:t})},block:!0,type:"primary",children:"Withdraw 1 NFT"})},me=e=>{let{rewardAddress:t}=e;return U(t).rewardType.nftCollection?(0,h.jsx)(ye,{rewardAddress:t}):(0,h.jsx)(we,{rewardAddress:t})},xe=()=>{const[e,t]=(0,n.useState)(!1);return{onDepositReward:async e=>{let{mint:a,campaign:n,totalPrize:r,reward:s}=e;t(!0);try{const{txId:e}=await window.luckyWheel.depositReward({campaign:new d.web3.PublicKey(n),reward:new d.web3.PublicKey(s),totalPrize:new d.BN(r),mint:new d.web3.PublicKey(a)});u("Deposit reward",e)}catch(i){p(i)}finally{t(!1)}},loading:e}},ge=e=>{let{rewardAddress:t}=e;const[a,r]=(0,n.useState)("0"),s=U(t),{onDepositReward:i,loading:c}=xe();return(0,h.jsxs)(l.Row,{gutter:[12,12],justify:"space-between",children:[(0,h.jsx)(l.Col,{children:(0,h.jsx)(l.Typography.Text,{children:"Total Prize:"})}),(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(l.InputNumber,{value:a,onChange:r,min:"0",style:{width:"100%"}})}),(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(l.Button,{onClick:async()=>{await i({campaign:s.campaign.toBase58(),reward:t,mint:s.mint.toBase58(),totalPrize:Number(a)})},block:!0,type:"primary",loading:c,children:"Deposit"})})]})};var je=a(66073);const Ce=e=>{let{rewardAddress:t}=e;const{onDepositReward:a}=xe(),n=U(t);return(0,h.jsx)(je.NFTSelection,{collectionAddress:[n.mint.toBase58()],onSelect:async e=>{await a({campaign:n.campaign.toBase58(),reward:t,mint:e,totalPrize:1})}})},fe=e=>{let{rewardAddress:t}=e;return U(t).rewardType.nftCollection?(0,h.jsx)(Ce,{rewardAddress:t}):(0,h.jsx)(ge,{rewardAddress:t})},be=e=>{let{rewardAddress:t}=e;const[a,r]=(0,n.useState)(!1),[s,i]=(0,n.useState)(""),c=U(t),{updateRatio:o,loading:w}=(()=>{const[e,t]=(0,n.useState)(!1);return{updateRatio:async e=>{let{campaign:a,rewardAddress:n,ratio:r}=e;t(!0);try{const e=new d.BN("1"+"0".repeat(18)).mul(new d.BN(r*10**9)).div(new d.BN(100*10**9)),{txId:s}=await window.luckyWheel.updateLuckyRatio({reward:new d.web3.PublicKey(n),campaign:new d.web3.PublicKey(a),fromLuckyNumber:new d.BN(0),toLuckyNumber:e});u("Update ratio",s)}catch(s){return p(s)}finally{t(!1)}},loading:e}})();return(0,h.jsx)(l.Popover,{content:(0,h.jsxs)(l.Collapse,{defaultActiveKey:["1"],children:[(0,h.jsx)(l.Collapse.Panel,{header:"Update Ratio",children:(0,h.jsxs)(l.Row,{gutter:[12,12],justify:"space-between",children:[(0,h.jsx)(l.Col,{children:(0,h.jsx)(l.Typography.Text,{children:"New Ratio:"})}),(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(l.InputNumber,{value:s,onChange:i,min:"0.0000000000000001",style:{width:"100%"}})}),(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(l.Button,{onClick:()=>{o({campaign:c.campaign.toBase58(),rewardAddress:t,ratio:Number(s)})},loading:w,block:!0,type:"primary",children:"Update"})})]})},"1"),(0,h.jsx)(l.Collapse.Panel,{header:"Deposit",children:(0,h.jsx)(fe,{rewardAddress:t})},"2"),(0,h.jsx)(l.Collapse.Panel,{header:"Withdraw",children:(0,h.jsx)(me,{rewardAddress:t})},"Withdraw")]}),trigger:"click",visible:a,onVisibleChange:r,placement:"bottomLeft",children:(0,h.jsx)(l.Button,{onClick:()=>r(!a),children:(0,h.jsx)(ie.default,{name:"create-outline"})})})},ke=[{title:"Avatar",dataIndex:"address",key:"address",render:e=>(0,h.jsxs)(l.Space,{children:[(0,h.jsx)(ae,{rewardAddress:e,size:32}),(0,h.jsx)(se,{rewardAddress:e})]})},{title:"Prize Amount",dataIndex:"address",key:"address",render:e=>(0,h.jsx)(X,{rewardAddress:e})},{title:"Total Prize",dataIndex:"totalPrize",key:"totalPrize",render:e=>(0,h.jsx)(l.Typography,{children:e.toNumber()})},{title:"Reserve Prize",dataIndex:"reservePrize",key:"reservePrize",render:e=>(0,h.jsx)(l.Typography,{children:e.toNumber()})},{title:"Ratio",dataIndex:"address",key:"address",render:e=>(0,h.jsx)(l.Typography.Text,{children:(0,h.jsx)($,{rewardAddress:e})})},{title:"Action",dataIndex:"address",key:"address",render:e=>(0,h.jsx)(be,{rewardAddress:e})}],Te=e=>{let{title:t,actionCreate:a,data:n}=e;return(0,h.jsx)(l.Row,{justify:"center",children:(0,h.jsx)(l.Col,{xs:24,lg:16,children:(0,h.jsx)(l.Table,{className:"reward",title:()=>(0,h.jsxs)(l.Row,{justify:"space-between",children:[(0,h.jsx)(l.Col,{children:(0,h.jsx)(l.Typography.Title,{level:4,style:{fontWeight:"bold"},children:t})}),(0,h.jsx)(l.Col,{children:a})]}),columns:ke,dataSource:n,bordered:!1,pagination:!1,style:{width:"100%"}},t)})})};var ve=a(95880),Ae=a.n(ve);const Se=e=>{let{setCollection:t}=e;const[a,r]=(0,n.useState)(!1);return(0,h.jsxs)(n.Fragment,{children:[(0,h.jsx)(l.Button,{onClick:()=>r(!0),children:"Select NFT"}),(0,h.jsx)(l.Modal,{visible:a,onCancel:()=>r(!1),footer:null,children:(0,h.jsx)(je.SearchNFT,{onSelect:e=>{t(e),r(!1)},searchNFTby:je.searchNFTType.collections})})]})},Re=()=>{const[e,t]=(0,n.useState)(!1),a=(0,n.useCallback)((async e=>{let{prizeAmount:a,campaign:n,ratio:r,rewardType:s,rewardMint:i}=e;t(!0);try{const e=new d.web3.PublicKey(n),l=d.web3.Keypair.generate(),{tx:c}=await window.luckyWheel.initializeReward({campaign:e,rewardMint:new d.web3.PublicKey(i),prizeAmount:a,rewardType:s,reward:l,sendAndConfirm:!1}),o=new d.BN("1"+"0".repeat(18)).mul(new d.BN(r*10**9)).div(new d.BN(100*10**9)),{tx:p}=await window.luckyWheel.updateLuckyRatio({campaign:new d.web3.PublicKey(n),reward:l.publicKey,fromLuckyNumber:new d.BN(0),toLuckyNumber:o,sendAndConfirm:!1}),h=new d.web3.Transaction;h.add(c),h.add(p);const w=await window.luckyWheel.provider.sendAndConfirm(h,[l]);u("Create reward",w)}catch(l){p(l)}finally{t(!1)}}),[]);return{createReward:a,loading:e}},Ne=e=>{let{campaignAddress:t}=e;const[a,r]=(0,n.useState)(!1),[s,i]=(0,n.useState)("0"),[c,o]=(0,n.useState)(""),{createReward:u,loading:p}=Re();return(0,h.jsxs)(n.Fragment,{children:[(0,h.jsx)(l.Button,{block:!0,type:"primary",onClick:()=>r(!0),children:"Add New"}),(0,h.jsx)(l.Modal,{title:"Create NFT Reward",visible:a,onCancel:()=>r(!1),onOk:async()=>{await u({prizeAmount:new d.BN(1),campaign:t,rewardMint:c,ratio:Number(s),rewardType:ve.REWARD_TYPE.nftCollection})},confirmLoading:p,children:(0,h.jsxs)(l.Row,{gutter:[24,24],children:[(0,h.jsx)(l.Col,{span:10,children:(0,h.jsx)(l.Typography.Text,{children:"Prize Amount :"})}),(0,h.jsx)(l.Col,{span:14,children:(0,h.jsx)(l.Typography.Text,{children:"1 NFT"})}),(0,h.jsx)(l.Col,{span:10,children:(0,h.jsx)(l.Typography.Text,{children:"Ratio (%) :"})}),(0,h.jsx)(l.Col,{span:14,children:(0,h.jsx)(l.InputNumber,{style:{width:"100%"},min:"0",max:"100",value:s,onChange:e=>i(e)})}),(0,h.jsx)(l.Col,{span:10,children:(0,h.jsx)(l.Typography.Text,{children:"Collection :"})}),(0,h.jsx)(l.Col,{span:14,children:(0,h.jsxs)(l.Space,{direction:"vertical",children:[(0,h.jsx)(Se,{setCollection:o}),c&&(0,h.jsx)(je.AvatarNFT,{mintAddress:c})]})})]})})]})},Pe=()=>{const e=M(),t=H(e),a=Object.keys(t).filter((e=>!!t[e].rewardType.nftCollection)).map((e=>({address:e,...t[e]})));return(0,h.jsx)(Te,{data:a,title:"NFT Rewards",actionCreate:(0,h.jsx)(Ne,{campaignAddress:e})})},Be=e=>{let{campaignAddress:t}=e;const[a,r]=(0,n.useState)(!1),[s,i]=(0,n.useState)("0"),[c,o]=(0,n.useState)("0"),{createReward:u,loading:p}=Re();return(0,h.jsxs)(n.Fragment,{children:[(0,h.jsx)(l.Button,{block:!0,type:"primary",onClick:()=>r(!0),children:"Add New"}),(0,h.jsxs)(l.Modal,{title:"Create Ticket Reward",visible:a,onCancel:()=>r(!1),onOk:async()=>{const e=await window.luckyWheel.deriveCampaignPDAs(new d.web3.PublicKey(t));await u({prizeAmount:new d.BN(s),campaign:t,rewardMint:e.ticketMint,ratio:Number(c),rewardType:ve.REWARD_TYPE.ticket})},confirmLoading:p,children:[(0,h.jsx)(l.Row,{justify:"center",style:{paddingBottom:16},children:(0,h.jsx)(l.Col,{children:(0,h.jsx)(l.Image,{preview:!1,style:{height:100,width:100},src:te})})}),(0,h.jsxs)(l.Row,{gutter:[24,24],children:[(0,h.jsx)(l.Col,{span:10,children:(0,h.jsx)(l.Typography.Text,{children:"Prize Amount :"})}),(0,h.jsx)(l.Col,{span:14,children:(0,h.jsx)(l.Input,{style:{width:"100%"},min:"0",value:s,onChange:e=>i(e.target.value)})}),(0,h.jsx)(l.Col,{span:10,children:(0,h.jsx)(l.Typography.Text,{children:"Ratio (%) :"})}),(0,h.jsx)(l.Col,{span:14,children:(0,h.jsx)(l.InputNumber,{style:{width:"100%"},min:"0",max:"100",value:c,onChange:e=>o(e)})})]})]})]})},Ie=()=>{const e=M(),t=H(e),a=Object.keys(t).filter((e=>!!t[e].rewardType.ticket)).map((e=>({address:e,...t[e]})));return(0,h.jsx)(Te,{data:a,title:"Ticket Rewards",actionCreate:(0,h.jsx)(Be,{campaignAddress:e})})};var Fe=a(4065),ze=a(70457);const Le=e=>{let{campaignAddress:t}=e;const[a,r]=(0,n.useState)(!1),[i,c]=(0,n.useState)("0"),[o,d]=(0,n.useState)("0"),[u,p]=(0,n.useState)(""),{createReward:w,loading:y}=Re(),m=(0,s.useGetMintDecimals)();return(0,h.jsxs)(n.Fragment,{children:[(0,h.jsx)(l.Button,{block:!0,type:"primary",onClick:()=>r(!0),children:"Add New"}),(0,h.jsx)(l.Modal,{title:"Create Token Reward",visible:a,onCancel:()=>r(!1),onOk:async()=>{const e=await m({mintAddress:u});if(!e)throw new Error("Cant not find decimals");const a=Fe.utilsBN.decimalize(i,e);await w({prizeAmount:a,campaign:t,rewardMint:u,ratio:Number(o),rewardType:ve.REWARD_TYPE.token})},confirmLoading:y,children:(0,h.jsxs)(l.Row,{gutter:[24,24],children:[(0,h.jsx)(l.Col,{span:10,children:(0,h.jsx)(l.Typography.Text,{children:"Token :"})}),(0,h.jsx)(l.Col,{span:14,children:(0,h.jsx)(ze.Z,{onChange:p})}),(0,h.jsx)(l.Col,{span:10,children:(0,h.jsx)(l.Typography.Text,{children:"Prize Amount :"})}),(0,h.jsx)(l.Col,{span:14,children:(0,h.jsx)(l.Input,{style:{width:"100%"},min:"0",value:i,onChange:e=>c(e.target.value)})}),(0,h.jsx)(l.Col,{span:10,children:(0,h.jsx)(l.Typography.Text,{children:"Ratio (%) :"})}),(0,h.jsx)(l.Col,{span:14,children:(0,h.jsx)(l.InputNumber,{style:{width:"100%"},min:"0",max:"100",value:o,onChange:e=>d(e)})})]})})]})},Me=()=>{const e=M(),t=H(e),a=Object.keys(t).filter((e=>!!t[e].rewardType.token)).map((e=>({address:e,...t[e]})));return(0,h.jsx)(Te,{data:a,title:"Token Rewards",actionCreate:(0,h.jsx)(Le,{campaignAddress:e})})},Ee=()=>(0,h.jsxs)(l.Row,{gutter:[24,24],children:[(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(Me,{})}),(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(Pe,{})}),(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(Ie,{})})]}),De=()=>{const[e,t]=(0,n.useState)(!1),a=(0,s.useGetMintDecimals)();return{withdrawChallengeReward:async e=>{let{challengeReward:n,mint:r,amount:s}=e;t(!0);try{const e=await a({mintAddress:r})||0,{txId:i}=await window.luckyWheel.withdrawChallengeReward({challengeReward:new d.web3.PublicKey(n),amount:Fe.utilsBN.decimalize(s,e),rewardMint:new d.web3.PublicKey(r)});u("Withdraw reward",i)}catch(i){p(i)}finally{t(!1)}},loading:e}},Oe=e=>{let{challengeRewardAddress:t}=e;const[a,r]=(0,n.useState)("0"),i=q(t),{withdrawChallengeReward:c,loading:o}=De(),d=(0,s.useMintDecimals)({mintAddress:i.mint.toBase58()})||0;return(0,h.jsxs)(l.Row,{gutter:[12,12],justify:"space-between",children:[(0,h.jsx)(l.Col,{children:(0,h.jsx)(l.Typography.Text,{children:"Total Prize:"})}),(0,h.jsx)(l.Col,{span:"auto",children:(0,h.jsx)(l.Space,{children:(0,h.jsxs)(l.Typography.Text,{type:"secondary",style:{cursor:"pointer"},onClick:()=>r(Fe.utilsBN.undecimalize(i.reserve,d)),children:["Available:"," ",s.util.numeric(Fe.utilsBN.undecimalize(i.reserve,d)).format("0,0.[0000]")]})})}),(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(l.InputNumber,{value:a,onChange:r,min:"0",style:{width:"100%"}})}),(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(l.Button,{onClick:async()=>{await c({amount:Number(a),mint:i.mint.toBase58(),challengeReward:t})},block:!0,type:"primary",loading:o,children:"Withdraw"})})]})},We="challengeReward",Ke=(0,f.createAsyncThunk)("challengeReward/initChallengeRewards",(async e=>e)),Ze=(0,f.createAsyncThunk)("challengeReward/upsetChallengeReward",(async e=>{let{address:t,data:a}=e;if(!le.account.isAddress(t))throw new Error("Invalid reward address");if(!a)throw new Error("Data is empty");return{[t]:a}})),_e=(0,f.createAsyncThunk)("challengeReward/getChallengeReward",(async(e,t)=>{let{address:a}=e,{getState:n}=t;const{challengeRewards:{[a]:r}}=n();return{[a]:r}})),He=(0,f.createSlice)({name:We,initialState:{},reducers:{},extraReducers:e=>{e.addCase(Ke.fulfilled,((e,t)=>{let{payload:a}=t;return a})).addCase(Ze.fulfilled,((e,t)=>{let{payload:a}=t;Object.assign(e,a)}))}}).reducer,Ve=()=>{const e=(0,r.useDispatch)();return(0,n.useCallback)((async t=>{const{[t]:a}=await e(_e({address:t})).unwrap(),{challengeRewardTreasurer:n}=await window.luckyWheel.deriveChallengeRewardPDAs(new d.web3.PublicKey(t),a.mint),{value:r}=await s.splt.connection.getTokenAccountsByOwner(n,{programId:s.splt.spltProgramId});return r.map((e=>s.splt.parseAccountData(e.account.data))).filter((e=>Number(e.amount.toString())>0))}),[e])},Ye=e=>{let{challengeRewardAddress:t}=e;const{withdrawChallengeReward:a,loading:n}=De(),r=Ve();return(0,h.jsx)(l.Button,{loading:n,onClick:async()=>{const e=await r(t);await a({amount:1,mint:e[0].mint,challengeReward:t})},block:!0,type:"primary",children:"Withdraw 1 NFT"})},Ge=e=>{let{challengeRewardAddress:t}=e;return q(t).rewardType.nftCollection?(0,h.jsx)(Ye,{challengeRewardAddress:t}):(0,h.jsx)(Oe,{challengeRewardAddress:t})},Ue=()=>{const[e,t]=(0,n.useState)(!1),a=(0,s.useGetMintDecimals)();return{onDepositChallengeReward:async e=>{let{mint:n,campaign:r,amount:s,challengeReward:i}=e;t(!0);try{const e=await a({mintAddress:n})||0,{txId:l}=await window.luckyWheel.depositChallengeReward({campaign:new d.web3.PublicKey(r),challengeReward:new d.web3.PublicKey(i),amount:Fe.utilsBN.decimalize(s,e),rewardMint:new d.web3.PublicKey(n)});return u("Deposited",l)}catch(l){p(l)}finally{t(!1)}},loading:e}},$e=(e,t,a)=>s.util.isAddress(e)&&void 0!==t&&void 0!==a?{mintAddress:e,amount:t,decimals:a,balance:Number(Fe.utilsBN.undecimalize(t,a))}:{amount:new d.BN(0),decimals:0,balance:0},Je=e=>{const[t,a]=(0,n.useState)(""),r=(0,s.useWalletAddress)(),i=(e=>{const t=(0,s.useWalletBalance)(),a=(0,s.useWalletAddress)(),n=(0,s.useAccounts)(),{amount:r,mint:i}=n[e]||{},l=(0,s.useMintDecimals)({mintAddress:i})||0;return s.util.isAddress(a)&&s.util.isAddress(e)?e===a?$e(le.DEFAULT_EMPTY_ADDRESS,new d.BN(t.toString()),9):$e(i,r?new d.BN(r.toString()):new d.BN(0),l):$e()})(t);return(0,n.useEffect)((()=>{(async()=>{if(!s.util.isAddress(r)||!s.util.isAddress(e))return a("");try{const t=await s.splt.deriveAssociatedAddress(r,e);a(t)}catch(t){return a("")}})()})),i},qe=e=>{let{challengeRewardAddress:t}=e;const[a,r]=(0,n.useState)("0"),i=q(t),{onDepositChallengeReward:c,loading:o}=Ue(),{balance:d}=Je(i.mint.toBase58());return(0,h.jsxs)(l.Row,{gutter:[12,12],justify:"space-between",children:[(0,h.jsx)(l.Col,{children:(0,h.jsx)(l.Typography.Text,{children:"amount:"})}),(0,h.jsx)(l.Col,{span:"auto",children:(0,h.jsx)(l.Space,{children:(0,h.jsxs)(l.Typography.Text,{type:"secondary",style:{cursor:"pointer"},onClick:()=>r(d.toString()),children:["Balance: ",s.util.numeric(d).format("0,0.[0000]")]})})}),(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(l.InputNumber,{value:a,onChange:r,min:"0",style:{width:"100%"}})}),(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(l.Button,{onClick:async()=>{await c({campaign:i.campaign.toBase58(),challengeReward:t,mint:i.mint.toBase58(),amount:Number(a)})},block:!0,type:"primary",loading:o,children:"Deposit"})})]})},Xe=e=>{let{challengeRewardAddress:t}=e;const{onDepositChallengeReward:a}=Ue(),n=q(t);return(0,h.jsx)(je.NFTSelection,{collectionAddress:[n.mint.toBase58()],onSelect:async e=>{await a({campaign:n.campaign.toBase58(),challengeReward:t,mint:e,amount:1})}})},Qe=e=>{let{challengeRewardAddress:t}=e;return(0,r.useSelector)((e=>e.challengeRewards[t])).rewardType.nftCollection?(0,h.jsx)(Xe,{challengeRewardAddress:t}):(0,h.jsx)(qe,{challengeRewardAddress:t})},et=e=>{let{rewardAddress:t}=e;const[a,r]=(0,n.useState)(!1);return(0,h.jsx)(l.Popover,{content:(0,h.jsxs)(l.Collapse,{defaultActiveKey:["1"],children:[(0,h.jsx)(l.Collapse.Panel,{header:"Deposit",children:(0,h.jsx)(Qe,{challengeRewardAddress:t})},"1"),(0,h.jsx)(l.Collapse.Panel,{header:"Withdraw",children:(0,h.jsx)(Ge,{challengeRewardAddress:t})},"Withdraw")]}),trigger:"click",visible:a,onVisibleChange:r,placement:"bottomLeft",children:(0,h.jsx)(l.Button,{onClick:()=>r(!a),children:(0,h.jsx)(ie.default,{name:"create-outline"})})})},tt=[{title:"Avatar",dataIndex:"address",key:"address",render:e=>(0,h.jsxs)(l.Space,{children:[(0,h.jsx)(ae,{rewardAddress:e,isChallenge:!0,size:32}),(0,h.jsx)(se,{isChallenge:!0,rewardAddress:e})]})},{title:"Amount",dataIndex:"address",key:"address",render:e=>(0,h.jsx)(X,{rewardAddress:e,isChallenge:!0})},{title:"Reserve",dataIndex:"reserve",key:"reserve",render:(e,t)=>{let{mint:a,rewardType:n}=t;return n.token?(0,h.jsx)(J.Z,{mintAddress:a.toBase58(),amount:e}):(0,h.jsx)(l.Typography.Text,{children:e.toString()})}},{title:"Total Picked",dataIndex:"totalPicked",key:"totalPicked",render:e=>(0,h.jsx)(l.Typography.Text,{children:e.toString()})},{title:"Action",dataIndex:"address",key:"address",render:e=>(0,h.jsx)(et,{rewardAddress:e})}],at=e=>{let{title:t,actionCreate:a,data:n}=e;return(0,h.jsx)(l.Row,{justify:"center",children:(0,h.jsx)(l.Col,{xs:24,lg:16,children:(0,h.jsx)(l.Table,{className:"reward",title:()=>(0,h.jsxs)(l.Row,{justify:"space-between",children:[(0,h.jsx)(l.Col,{children:(0,h.jsx)(l.Typography.Title,{level:4,style:{fontWeight:"bold"},children:t})}),(0,h.jsx)(l.Col,{children:a})]}),columns:tt,dataSource:n,bordered:!1,pagination:!1,style:{width:"100%"},rowKey:e=>e.address},t)})})},nt=e=>{let{setCollection:t}=e;const[a,r]=(0,n.useState)(!1);return(0,h.jsxs)(n.Fragment,{children:[(0,h.jsx)(l.Button,{onClick:()=>r(!0),children:"Select NFT"}),(0,h.jsx)(l.Modal,{visible:a,onCancel:()=>r(!1),footer:null,children:(0,h.jsx)(je.SearchNFT,{onSelect:e=>{t(e),r(!1)},searchNFTby:je.searchNFTType.collections})})]})},rt=()=>{const[e,t]=(0,n.useState)(!1);return{createChallengeReward:(0,n.useCallback)((async e=>{let{amount:a,campaign:n,totalPicked:r,rewardType:s,rewardMint:i}=e;t(!0);try{const e=new d.web3.PublicKey(n),l=d.web3.Keypair.generate(),{txId:c}=await window.luckyWheel.initializeChallengeReward({campaign:e,rewardMint:new d.web3.PublicKey(i),amount:a,rewardType:s,challengeReward:l,totalPicked:r,sendAndConfirm:!0});u("Created Challenge reward",c)}catch(l){p(l)}finally{t(!1)}}),[]),loading:e}},st=e=>{let{campaignAddress:t}=e;const[a,r]=(0,n.useState)(!1),[s,i]=(0,n.useState)("0"),[c,o]=(0,n.useState)(""),{createChallengeReward:u,loading:p}=rt();return(0,h.jsxs)(n.Fragment,{children:[(0,h.jsx)(l.Button,{block:!0,type:"primary",onClick:()=>r(!0),children:"Add New"}),(0,h.jsx)(l.Modal,{title:"Create NFT Reward",visible:a,onCancel:()=>r(!1),onOk:async()=>{await u({totalPicked:new d.BN(s),campaign:t,rewardMint:c,rewardType:ve.REWARD_TYPE.nftCollection,amount:new d.BN(1)})},confirmLoading:p,children:(0,h.jsxs)(l.Row,{gutter:[24,24],children:[(0,h.jsx)(l.Col,{span:10,children:(0,h.jsx)(l.Typography.Text,{children:"Prize Amount:"})}),(0,h.jsx)(l.Col,{span:14,children:(0,h.jsx)(l.Typography.Text,{children:"1 NFT"})}),(0,h.jsx)(l.Col,{span:10,children:(0,h.jsx)(l.Typography.Text,{children:"Total picked:"})}),(0,h.jsx)(l.Col,{span:14,children:(0,h.jsx)(l.InputNumber,{style:{width:"100%"},min:"0",value:s,onChange:e=>i(e)})}),(0,h.jsx)(l.Col,{span:10,children:(0,h.jsx)(l.Typography.Text,{children:"Collection :"})}),(0,h.jsx)(l.Col,{span:14,children:(0,h.jsxs)(l.Space,{direction:"vertical",children:[(0,h.jsx)(nt,{setCollection:o}),c&&(0,h.jsx)(je.AvatarNFT,{mintAddress:c})]})})]})})]})},it=e=>{const t=(0,r.useSelector)((e=>e.challengeRewards));return(0,n.useMemo)((()=>{const a={};for(const n in t){const{campaign:r}=t[n];r.toBase58()===e&&(a[n]=t[n])}return a}),[t,e])},lt=()=>{const e=M(),t=it(e),a=Object.keys(t).filter((e=>!!t[e].rewardType.nftCollection)).map((e=>({address:e,...t[e]})));return(0,h.jsx)(at,{data:a,title:"NFT Rewards",actionCreate:(0,h.jsx)(st,{campaignAddress:e})})},ct=e=>{let{campaignAddress:t}=e;const[a,r]=(0,n.useState)(!1),[s,i]=(0,n.useState)("0"),[c,o]=(0,n.useState)("0"),{createChallengeReward:u,loading:p}=rt();return(0,h.jsxs)(n.Fragment,{children:[(0,h.jsx)(l.Button,{block:!0,type:"primary",onClick:()=>r(!0),children:"Add New"}),(0,h.jsxs)(l.Modal,{title:"Create Ticket Reward",visible:a,onCancel:()=>r(!1),onOk:async()=>{const e=await window.luckyWheel.deriveCampaignPDAs(new d.web3.PublicKey(t));await u({amount:new d.BN(s),campaign:t,rewardMint:e.ticketMint,totalPicked:new d.BN(c),rewardType:ve.REWARD_TYPE.ticket})},confirmLoading:p,children:[(0,h.jsx)(l.Row,{justify:"center",style:{paddingBottom:16},children:(0,h.jsx)(l.Col,{children:(0,h.jsx)(l.Image,{preview:!1,style:{height:100,width:100},src:te})})}),(0,h.jsxs)(l.Row,{gutter:[24,24],children:[(0,h.jsx)(l.Col,{span:10,children:(0,h.jsx)(l.Typography.Text,{children:"Prize Amount:"})}),(0,h.jsx)(l.Col,{span:14,children:(0,h.jsx)(l.Input,{style:{width:"100%"},min:"0",value:s,onChange:e=>i(e.target.value)})}),(0,h.jsx)(l.Col,{span:10,children:(0,h.jsx)(l.Typography.Text,{children:"Total picked:"})}),(0,h.jsx)(l.Col,{span:14,children:(0,h.jsx)(l.InputNumber,{style:{width:"100%"},min:"0",value:c,onChange:e=>o(e)})})]})]})]})},ot=()=>{const e=M(),t=it(e),a=Object.keys(t).filter((e=>!!t[e].rewardType.ticket)).map((e=>({address:e,...t[e]})));return(0,h.jsx)(at,{data:a,title:"Ticket Rewards",actionCreate:(0,h.jsx)(ct,{campaignAddress:e})})},dt=e=>{let{campaignAddress:t}=e;const[a,r]=(0,n.useState)(!1),[i,c]=(0,n.useState)("0"),[o,u]=(0,n.useState)("0"),[p,w]=(0,n.useState)(""),{createChallengeReward:y,loading:m}=rt(),x=(0,s.useGetMintDecimals)();return(0,h.jsxs)(n.Fragment,{children:[(0,h.jsx)(l.Button,{block:!0,type:"primary",onClick:()=>r(!0),children:"Add New"}),(0,h.jsx)(l.Modal,{title:"Create Token Reward",visible:a,onCancel:()=>r(!1),onOk:async()=>{const e=await x({mintAddress:p});if(!e)throw new Error("Cant not find decimals");const a=Fe.utilsBN.decimalize(i,e);await y({amount:a,campaign:t,rewardMint:p,totalPicked:new d.BN(o),rewardType:ve.REWARD_TYPE.token})},confirmLoading:m,children:(0,h.jsxs)(l.Row,{gutter:[24,24],children:[(0,h.jsx)(l.Col,{span:10,children:(0,h.jsx)(l.Typography.Text,{children:"Token:"})}),(0,h.jsx)(l.Col,{span:14,children:(0,h.jsx)(ze.Z,{onChange:w})}),(0,h.jsx)(l.Col,{span:10,children:(0,h.jsx)(l.Typography.Text,{children:"Prize Amount:"})}),(0,h.jsx)(l.Col,{span:14,children:(0,h.jsx)(l.Input,{style:{width:"100%"},min:"0",value:i,onChange:e=>c(e.target.value)})}),(0,h.jsx)(l.Col,{span:10,children:(0,h.jsx)(l.Typography.Text,{children:"Total picked:"})}),(0,h.jsx)(l.Col,{span:14,children:(0,h.jsx)(l.InputNumber,{style:{width:"100%"},min:"0",value:o,onChange:e=>u(e)})})]})})]})},ut=()=>{const e=M(),t=it(e),a=Object.keys(t).filter((e=>!!t[e].rewardType.token)).map((e=>({address:e,...t[e]})));return(0,h.jsx)(at,{data:a,title:"Token Rewards",actionCreate:(0,h.jsx)(dt,{campaignAddress:e})})},pt=()=>(0,h.jsxs)(l.Row,{gutter:[24,24],children:[(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(ut,{})}),(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(lt,{})}),(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(ot,{})})]}),ht=[{label:"Management Reward",value:"reward"},{label:"Management Challenge Reward",value:"challenge"}],wt=()=>{const[e,t]=(0,n.useState)("reward");return(0,h.jsxs)(l.Row,{gutter:[24,24],justify:"center",children:[(0,h.jsx)(G,{}),(0,h.jsx)(l.Col,{span:10,children:(0,h.jsx)(l.Segmented,{value:e,onChange:e=>t(e.toString()),options:ht,size:"large"})}),(0,h.jsx)(l.Col,{span:24,children:"challenge"===e?(0,h.jsx)(pt,{}):(0,h.jsx)(Ee,{})}),(0,h.jsx)(l.Col,{span:24})]})};var yt=a(36645),mt=a(4550),xt=a.n(mt);const gt=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const a=(0,r.useSelector)((e=>e.tickets)),i=(0,s.useWalletAddress)(),l=(0,n.useMemo)((()=>{const n={};for(const r in a){const{authority:s,campaign:l}=a[r];l.toBase58()===e&&(s.toBase58()!==i&&t||(n[r]=a[r]))}return n}),[e,t,a,i]);return l},jt=()=>{const e=M();return(0,n.useCallback)((async t=>{if(!t)return[];let a=7,n=[];for(let r=0;r<t;r+=a){const s=new d.web3.Transaction,i=[];(r+a>t||a>t)&&(a=t-r);for(let t=0;t<a;t++){const t=d.web3.Keypair.generate(),{tx:a}=await window.luckyWheel.redeemTicket({campaign:new d.web3.PublicKey(e),ticket:t,sendAndConfirm:!1});s.add(a),i.push(t)}n.push({tx:s,signers:i})}return n}),[e])},Ct=e=>{let{ticketAddress:t}=e;const a=M(),r=gt(a),{state:i}=r[t],{onClaim:c,loading:o}=(()=>{const[e,t]=(0,n.useState)(!1),a=M(),r=H(a),i=gt(a),l=jt(),c=(0,n.useCallback)((async e=>{const{mint:t}=r[e],{rewardTreasurer:a}=await window.luckyWheel.deriveRewardPDAs(new d.web3.PublicKey(e),t),{value:n}=await s.splt.connection.getTokenAccountsByOwner(a,{programId:s.splt.spltProgramId});for(const r of n){const e=s.splt.parseAccountData(r.account.data);if(Number(e.amount.toString())>0)return new d.web3.PublicKey(e.mint)}throw new Error("Can't find account")}),[r]);return{onClaim:(0,n.useCallback)((async e=>{try{t(!0);let a=[];const n=i[e].reward.toBase58(),{rewardType:s,mint:o,prizeAmount:u}=r[n];let p=o;s.nftCollection&&(p=await c(n));const{tx:h}=await window.luckyWheel.claim({ticket:new d.web3.PublicKey(e),mint:p,sendAndConfirm:!1});if(a.push({tx:h,signers:[]}),s.ticket){const e=await l(u.toNumber());a=a.concat(...e)}return await window.luckyWheel.provider.sendAll(a.map((e=>{let{tx:t,signers:a}=e;return{tx:t,signers:a}})),{commitment:"finalized",preflightCommitment:"finalized"}),window.notify({type:"success",description:"Claimed reward successfully."})}catch(a){return p(a)}finally{t(!1)}}),[c,l,r,i]),loading:e}})();return i.claimed?(0,h.jsx)(l.Typography.Title,{level:5,children:"CLAIMED"}):(0,h.jsx)(l.Button,{loading:o,type:"primary",onClick:()=>c(t),children:"CLAIM"})},ft=e=>{let{history:t}=e;return(0,h.jsx)(l.Card,{bodyStyle:{padding:16},className:"list-reward",bordered:!1,children:t.length?(0,h.jsx)(l.Row,{gutter:[16,16],children:t.map((e=>{let{reward:t,ticketAddress:a,pickAt:n}=e;return(0,h.jsx)(l.Col,{span:24,className:"list-reward_item",children:(0,h.jsxs)(l.Row,{align:"top",children:[(0,h.jsx)(l.Col,{flex:"auto",children:(0,h.jsxs)(l.Space,{direction:"vertical",children:[(0,h.jsxs)(l.Space,{children:[(0,h.jsx)(ae,{size:24,rewardAddress:t.toBase58()}),(0,h.jsx)(X,{rewardAddress:t.toBase58()}),(0,h.jsx)(se,{rewardAddress:t.toBase58()})]}),(0,h.jsx)(l.Typography.Text,{type:"secondary",children:xt()(1e3*n.toNumber()).format("MMM DD, YYYY HH:mm")})]})}),(0,h.jsx)(l.Col,{children:(0,h.jsx)(Ct,{ticketAddress:a})})]})},a)}))}):(0,h.jsx)(l.Empty,{description:"You don't have any reward"})})},bt=()=>{const e=M(),t=gt(e),[a,r]=(0,n.useState)(!1),i=(0,s.useInfix)(),c=(0,n.useMemo)((()=>{const e=[];for(const n in t){const r=t[n],s=r.state;(s.claimed&&!a||s.won)&&e.push({...r,ticketAddress:n})}return e}),[a,t]).sort(((e,t)=>{const a=e.pickAt.toNumber();return t.pickAt.toNumber()-a})),o=[{title:"TIME",dataIndex:"pickAt",key:"pickAt",render:e=>(0,h.jsx)(l.Typography.Text,{children:xt()(1e3*e.toNumber()).format("MMM DD, YYYY HH:mm")})},{title:"REWARD",dataIndex:"reward",key:"reward",render:e=>(0,h.jsxs)(l.Space,{children:[(0,h.jsx)(ae,{size:24,rewardAddress:e.toBase58()}),(0,h.jsx)(se,{rewardAddress:e.toBase58()})]})},{title:"AMOUNT",dataIndex:"reward",key:"reward",render:e=>(0,h.jsx)(X,{rewardAddress:e.toBase58()})},{title:"ACTIONS",dataIndex:"ticketAddress",key:"ticketAddress",render:e=>(0,h.jsx)(Ct,{ticketAddress:e})}];return(0,h.jsxs)(l.Row,{gutter:[12,12],children:[(0,h.jsx)(l.Col,{span:24,style:{textAlign:"right"},children:(0,h.jsxs)(l.Space,{children:[(0,h.jsx)(l.Typography.Text,{children:"Claim only"}),(0,h.jsx)(l.Switch,{onChange:r,size:"small"})]})}),(0,h.jsx)(l.Col,{span:24,children:i===s.Infix.xs?(0,h.jsx)(ft,{history:c}):(0,h.jsx)(l.Table,{dataSource:c,columns:o,pagination:!1,rowKey:e=>e.ticketAddress})})]})},kt=e=>{let{children:t,size:a=48}=e;return(0,h.jsxs)("div",{style:{width:a+4,height:a+4},className:"shadow-rotate",children:[(0,h.jsx)("div",{className:"inner-color",children:t}),new Array(4).fill("span-item-").map(((e,t)=>(0,h.jsx)("span",{className:e+t},t)))]})},Tt=e=>{let{material:t,isBest:a=!1}=e;const{rewardAddress:r}=t,i=(0,s.useWidth)(),c=(0,n.useMemo)((()=>i<590?24:i<427?12:48),[i]);return(0,h.jsxs)(l.Space,{style:{zIndex:3,position:"relative"},direction:"vertical",size:0,children:[a?(0,h.jsx)(kt,{size:c,children:(0,h.jsx)(ae,{rewardAddress:r,size:c})}):(0,h.jsx)(ae,{rewardAddress:r,size:c}),(0,h.jsx)(l.Typography.Title,{level:5,style:{color:"#212433",fontFamily:"Nunito",fontWeight:"bold"},children:(0,h.jsx)(X,{rewardAddress:r})}),(0,h.jsx)(l.Typography.Text,{style:{color:"#212433",fontFamily:"Nunito",fontSize:10},children:(0,h.jsx)(se,{rewardAddress:r})})]})},vt=e=>{const t=(0,r.useSelector)((e=>e.tickets)),a=(0,s.useWalletAddress)();return(0,n.useMemo)((()=>{const n={};for(const r in t){const s=t[r],{authority:i,campaign:l}=s;i.toBase58()===a&&l.toBase58()===e&&s.state.initialized&&(n[r]=s)}return n}),[e,t,a])},At=a.p+"static/media/fail.79d676604b51c28bdef4.mp3";let St=new Audio(At);const Rt=e=>{let{onClose:t,visible:a,onSpinning:r}=e;const i=M(),c=vt(i);return(0,n.useEffect)((()=>{if(!a)return St.currentTime=0,void St.pause();(async()=>{St.play(),await s.util.asyncWait(5e3),St.pause()})()}),[a]),(0,h.jsx)(l.Modal,{visible:a,onCancel:()=>t(!1),footer:null,closeIcon:(0,h.jsx)(ie.default,{name:"close-outline"}),className:"congrats",children:(0,h.jsxs)(l.Row,{gutter:[16,16],className:"congrats_content",children:[(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(l.Avatar,{size:96,shape:"circle",src:ee})}),(0,h.jsx)(l.Col,{span:24})," ",(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(l.Typography.Title,{level:4,className:"gradient-text",children:"So Close!"})}),(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(l.Typography.Text,{type:"secondary",children:"You have almost reached. Try again."})}),(0,h.jsx)(l.Col,{span:24})," ",(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(l.Button,{type:"primary",size:"large",block:!0,onClick:()=>{t(!1),r(1,!1)},disabled:!Object.keys(c).length,children:"SPIN AGAIN"})})]})})};const Nt=a.p+"static/media/bg-popup.91133c926245c4382d5a3b2ab660d0a6.svg",Pt=a.p+"static/media/winner.726b163ee6fbabfae0b3.mp3";let Bt=new Audio(Pt);const It=e=>{let{onClose:t,visible:a,pickedTickets:i,onSpinning:c}=e;const o=M(),d=vt(o),u=gt(o),p=(0,r.useDispatch)();return(0,n.useEffect)((()=>{if(!a)return Bt.currentTime=0,Bt.pause(),void p(F({confetti:N}));(async()=>{p(F({confetti:R})),Bt.play(),await s.util.asyncWait(5e3),p(F({confetti:N})),Bt.pause()})()}),[p,a]),(0,h.jsxs)(l.Modal,{visible:a,onCancel:()=>t(!1),footer:null,closeIcon:(0,h.jsx)(ie.default,{name:"close-outline"}),className:"congrats",children:[(0,h.jsx)(l.Image,{preview:!1,src:Nt,style:{borderRadius:16}}),(0,h.jsxs)(l.Row,{gutter:[16,16],className:"congrats_content",children:[(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(l.Typography.Title,{level:4,className:"gradient-text",children:"Congratulations!"})}),(0,h.jsx)(l.Col,{span:24,children:(0,h.jsxs)(l.Typography.Text,{children:["You have received ",i.length," reward!"]})}),(0,h.jsx)(l.Col,{span:24})," ",(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(l.Row,{gutter:[16,16],children:i.map((e=>{const t=u[e].reward.toBase58();return(0,h.jsx)(l.Col,{span:1===i.length?24:12,children:(0,h.jsxs)(l.Space,{size:16,direction:"vertical",children:[(0,h.jsx)(ae,{size:96,rewardAddress:t}),(0,h.jsxs)(l.Typography.Title,{level:3,children:[(0,h.jsx)(X,{rewardAddress:t})," ",(0,h.jsx)(se,{rewardAddress:t})]})]})},e)}))})}),(0,h.jsx)(l.Col,{span:24})," ",(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(l.Button,{onClick:()=>{p(z({tabId:T.Reward})),t(!1)},size:"large",type:"primary",block:!0,children:"GET YOUR REWARDS"})}),(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(l.Button,{size:"large",block:!0,onClick:()=>{t(!1),c(1,!1)},disabled:!Object.keys(d).length,children:"SPIN MORE"})})]})]})},Ft=e=>{let{pickedTickets:t,onSpinning:a}=e;const[r,s]=(0,n.useState)(!1),i=M(),l=gt(i),c=(0,n.useMemo)((()=>t.filter((e=>l[e].state.won))),[t,l]);return(0,n.useEffect)((()=>{s(!!t.length)}),[t]),c.length?(0,h.jsx)(It,{pickedTickets:c,visible:r,onClose:()=>s(!1),onSpinning:a}):(0,h.jsx)(Rt,{visible:r,onSpinning:a,onClose:()=>s(!1)})},zt=[{title:"NO.",dataIndex:"index",key:"index",render:e=>(0,h.jsxs)(l.Typography.Text,{children:[" ",e+1," "]})},{title:"REWARD",dataIndex:"address",key:"address",render:e=>(0,h.jsxs)(l.Space,{children:[(0,h.jsx)(ae,{rewardAddress:e,size:32}),(0,h.jsx)(X,{rewardAddress:e}),(0,h.jsx)(se,{rewardAddress:e})]})},{title:"REMAINING",dataIndex:"reservePrize",key:"reservePrize",render:e=>(0,h.jsx)(l.Typography.Text,{children:s.util.numeric(e.toNumber()).format("0,0.[0000]")})},{title:"WINNING PROBABILITY",dataIndex:"address",key:"address",render:e=>(0,h.jsx)(l.Typography.Text,{children:(0,h.jsx)($,{rewardAddress:e})})}],Lt=e=>{let{visible:t,onClose:a}=e;const r=M(),s=H(r),i=(0,n.useMemo)((()=>{let e=Object.keys(s).map((e=>({address:e,...s[e]})));return e.sort(((e,t)=>Number(e.toLuckyNumber.sub(e.fromLuckyNumber))/10**18-Number(t.toLuckyNumber.sub(t.fromLuckyNumber))/10**18)),e.map(((e,t)=>({...e,index:t})))}),[s]);return(0,h.jsx)(l.Modal,{visible:t,onCancel:()=>a(!1),footer:null,style:{padding:0},className:"reward-info",title:(0,h.jsx)(l.Typography.Title,{level:4,children:"Reward information"}),children:(0,h.jsx)(l.Row,{children:(0,h.jsx)(l.Col,{span:24,style:{maxHeight:300},className:"scrollbar",children:(0,h.jsx)(l.Table,{columns:zt,dataSource:i,bordered:!1,pagination:!1,style:{width:"100%"},rowKey:e=>e.address})})})})};var Mt=a(97429).Buffer;const Et=e=>{let t=new d.BN(0);for(let a=0;a<18;a++){let n=new d.BN(e[a]%10);t=t.add(n.mul(new d.BN(1+"0".repeat(a))))}return t},Dt=e=>{const t=vt(e),a=(e=>{const t=H(e);return(0,n.useCallback)((async()=>{let e=[];for(const a in t){const{reservePrize:n}=t[a];n.isZero()||e.push(new d.web3.PublicKey(a))}return e=e.sort(((e,a)=>{const n=t[e.toBase58()].toLuckyNumber,r=t[a.toBase58()].toLuckyNumber;return n.gt(r)?1:-1})),e}),[t])})(e),i=(()=>{const e=M(),t=(0,r.useSelector)((t=>t.campaigns[e].picker)),a=(0,s.useWalletAddress)();return(0,n.useCallback)((async e=>{const{data:n}=await D().get(C.api.lottery.publicKey,{withCredentials:!0}),r=await window.luckyWheel.decodePickerPublickey(n);let i=window.luckyWheel.picker.sign(new d.web3.PublicKey(e).toBuffer());if(JSON.stringify(t)===JSON.stringify(r)){const t=new s.PDB(a).createInstance(C.manifest.appId);let n=await t.getItem(e);if(!n){const{data:a}=await D().get(C.api.lottery.luckyNumber+e,{withCredentials:!0});await t.setItem(e,a),n=a}i={signature:Mt.from(n.signature,"hex"),recid:n.recid}}const l=Array.from(i.signature);return{ticket:new d.web3.PublicKey(e),recoveryId:i.recid,signature:l,luckyNumber:Et(l)}}),[t,a])})();return(0,n.useCallback)((async n=>{const r=Object.keys(t);if(r.length<n)throw new Error("Insufficient ticket");const s=r.slice(0,n);let l=[];try{const{lotteryInfo:t}=await window.luckyWheel.deriveCampaignPDAs(new d.web3.PublicKey(e));await window.luckyWheel.program.account.lotteryInfo.fetch(t)}catch(o){const{tx:t}=await window.luckyWheel.initializeLotteryInfo({campaign:new d.web3.PublicKey(e),sendAndConfirm:!1});l.push(t)}const c=s.map((async e=>{const t=await i(e),n=await a(),r=new d.web3.Transaction,{tx:s}=await window.luckyWheel.pickLuckyNumber({...t,sendAndConfirm:!1});r.add(s);const{tx:l}=await window.luckyWheel.checkPrize({...t,rewards:n,sendAndConfirm:!1});return r.add(l),r}));return l=l.concat(await Promise.all(c)),await window.luckyWheel.provider.sendAll(l.map((e=>({tx:e}))),{commitment:"finalized",preflightCommitment:"finalized"}),s}),[t,e,a,i])},Ot=a.p+"static/media/arrow.819fcbae1cab8f5a9996.png",Wt=a.p+"static/media/sound.b65c6942e825307bfb6f.mp3";let Kt=new Audio(Wt);const Zt=e=>{let{rewards:t}=e;const[a,r]=(0,n.useState)(!1),[s,i]=(0,n.useState)(!1),[c,o]=(0,n.useState)(!1),[d,u]=(0,n.useState)([]),p=M(),w=H(p),y=vt(p),m=Dt(p),x=360/t.length,g=90-x,j=x/2,C=(0,n.useMemo)((()=>{if(!t.length||!Object.keys(w).length)return[];const e={};for(const{rewardAddress:n}of t){if("good-luck"===n)continue;const{toLuckyNumber:t,fromLuckyNumber:a}=w[n],r=Number(t.sub(a))/10**18;e[n]=r}const a=Object.values(e).sort().slice(0,3);return Object.keys(e).filter((t=>a.includes(e[t])))}),[w,t]),f=(0,n.useMemo)((()=>{const e=new Map;for(let a=0;a<t.length;a++)e.set(t[a].rewardAddress,a*x);return e}),[t,x]),T=(0,n.useMemo)((()=>{let e=0;const a=[];for(let n=1;n<=t.length;n++)k[e]||(e=0,n===t.length&&[a[0],a[n-1]].includes(k[e])&&e++),a.push(k[e]),e++;return a}),[t.length]),v=async(e,t)=>{let a=[];try{t?o(!0):i(!0),a=await m(e),Kt.play();let n=document.getElementById("wheel");if(!n)return;const r=-2e4,s=-1e4;let l=Math.floor(Math.random()*(r-s+1))+s;n.style.transform="rotate("+l+"deg)",n.style.transition="3s all";let c=b.GoodLuck;const d=await window.luckyWheel.account.ticket.fetch(a[0]);d.state.won&&(c=d.reward.toBase58()),setTimeout((()=>{n&&(l=-(f.get(c||b.GoodLuck)||0)-j,n.style.transform="rotate("+l+"deg)")}),2e3)}catch(n){(e=>{console.log(e),"Request failed with status code 429"===e.message?window.notify({type:"info",description:"\ud83e\udd79 You have reached the maximum number of spins that is 10 spins per day. Let's be back tomorrow \u2600\ufe0f"}):window.notify({type:"info",description:"The Solana network is experiencing degraded performance, and this leads to your ticket not instantly available. Let's try again in 2-5 minutes later."})})(n)}finally{setTimeout((()=>{Kt.pause(),Kt.currentTime=0,i(!1),o(!1),u(a)}),5e3)}},A=s||c||!Object.keys(y).length;return(0,h.jsxs)(l.Row,{gutter:[0,32],children:[(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)("div",{className:"container",children:(0,h.jsxs)("div",{className:"container-body",children:[(0,h.jsx)(l.Image,{src:Ot,id:"stopper",preview:!1}),(0,h.jsx)("ul",{className:"circle",id:"wheel",children:t.map(((e,t)=>{const a=C.includes(e.rewardAddress);return(0,h.jsxs)("li",{style:{transform:`rotate(${t*x}deg) skewY(-${g}deg)`},children:[(0,h.jsxs)("div",{style:{transform:`skewY(${g}deg) rotate(${j}deg)`},className:"text",children:[(0,h.jsx)("div",{className:"bg",style:{background:`${a?"radial-gradient(47.41% 47.41% at 49.98% 50.04%, #CC9D1D 10.07%, #FFCA38 58.27%, #FFE18F 85.66%, #FFDE85 92.66%, #EBB72A 100%)":T[t]}`}}),(0,h.jsx)(Tt,{material:e,isBest:a})]}),a&&new Array(15).fill("firework-").map(((e,t)=>(0,h.jsx)("div",{className:e+t,style:{transform:`skewY(${g}deg)`}},t)))]},e.rewardAddress)}))})]})})}),(0,h.jsx)(l.Col,{span:24,children:(0,h.jsxs)(l.Row,{gutter:[16,16],children:[(0,h.jsx)(l.Col,{xs:24,lg:12,children:(0,h.jsx)(l.Button,{size:"large",block:!0,disabled:A,onClick:()=>v(1,!1),loading:s,type:"primary",children:"SPIN"})}),(0,h.jsx)(l.Col,{xs:24,lg:12,children:(0,h.jsx)(l.Button,{size:"large",block:!0,onClick:()=>r(!0),children:"Rewards Infomation"})})]})}),(0,h.jsx)(Lt,{visible:a,onClose:r}),(0,h.jsx)(Ft,{onSpinning:v,pickedTickets:d})]})},_t=()=>{const[e,t]=(0,n.useState)(0),[a,r]=(0,n.useState)(""),i=(0,s.useAccounts)(),l=M(),c=(0,n.useCallback)((async()=>{try{const{ticketMint:e}=await window.luckyWheel.deriveCampaignPDAs(new d.web3.PublicKey(l)),a=e.toBase58();r(a);for(const n in i){const{mint:e,amount:r}=i[n];if(e===a)return t(Number(r))}}catch(e){}}),[i,l]);return(0,n.useEffect)((()=>{c()}),[c]),{totalTicket:e,ticketMintAddr:a}};var Ht,Vt;function Yt(){return Yt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},Yt.apply(this,arguments)}function Gt(e,t){let{title:a,titleId:r,...s}=e;return n.createElement("svg",Yt({width:17,height:14,viewBox:"0 0 17 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":r},s),a?n.createElement("title",{id:r},a):null,Ht||(Ht=n.createElement("path",{d:"M12.3745 0.216797L6.75786 0.216797V2.73346C6.75786 3.05846 6.4912 3.3168 6.17453 3.3168C5.85786 3.3168 5.5912 3.05846 5.5912 2.73346V0.216797L4.62453 0.216797C1.33286 0.216797 0.249528 1.20013 0.174528 4.27513C0.166195 4.42513 0.232862 4.58346 0.341195 4.6918C0.449528 4.80846 0.591195 4.8668 0.757862 4.8668C1.92453 4.8668 2.88286 5.83346 2.88286 7.00013C2.88286 8.1668 1.92453 9.13346 0.757862 9.13346C0.599528 9.13346 0.449528 9.1918 0.341195 9.30846C0.232862 9.4168 0.166195 9.57513 0.174528 9.72513C0.249528 12.8001 1.33286 13.7835 4.62453 13.7835H5.5912V11.2668C5.5912 10.9418 5.85786 10.6835 6.17453 10.6835C6.4912 10.6835 6.75786 10.9418 6.75786 11.2668V13.7835H12.3745C15.7912 13.7835 16.8329 12.7418 16.8329 9.32513V4.67513C16.8329 1.25846 15.7912 0.216797 12.3745 0.216797ZM13.8912 6.9168L13.1162 7.6668C13.0829 7.6918 13.0745 7.7418 13.0829 7.78346L13.2662 8.8418C13.2995 9.03346 13.2245 9.23346 13.0579 9.35013C12.8995 9.4668 12.6912 9.48346 12.5162 9.3918L11.5579 8.8918C11.5245 8.87513 11.4745 8.87513 11.4412 8.8918L10.4829 9.3918C10.4079 9.43346 10.3245 9.45013 10.2412 9.45013C10.1329 9.45013 10.0329 9.4168 9.94119 9.35013C9.78286 9.23346 9.69953 9.0418 9.73286 8.8418L9.9162 7.78346C9.92453 7.7418 9.90786 7.70013 9.88286 7.6668L9.10786 6.9168C8.96619 6.78346 8.91619 6.57513 8.97453 6.3918C9.03286 6.20013 9.19119 6.0668 9.39119 6.0418L10.4579 5.88346C10.4995 5.87513 10.5329 5.85013 10.5579 5.8168L11.0329 4.85013C11.1245 4.67513 11.2995 4.5668 11.4995 4.5668C11.6995 4.5668 11.8745 4.67513 11.9579 4.85013L12.4329 5.8168C12.4495 5.85846 12.4829 5.88346 12.5245 5.88346L13.5912 6.0418C13.7912 6.0668 13.9495 6.20846 14.0079 6.3918C14.0829 6.57513 14.0329 6.77513 13.8912 6.9168Z",fill:"url(#paint0_linear_12611_1727)"})),Vt||(Vt=n.createElement("defs",null,n.createElement("linearGradient",{id:"paint0_linear_12611_1727",x1:.173828,y1:13.7835,x2:18.2362,y2:11.5461,gradientUnits:"userSpaceOnUse"},n.createElement("stop",{stopColor:"#9945FF"}),n.createElement("stop",{offset:1,stopColor:"#B9F8FD"})))))}const Ut=n.forwardRef(Gt),$t=(a.p,()=>{const e=M(),t=H(e),a=vt(e),{totalTicket:r}=_t(),{loading:s,claimRawTicket:i}=(()=>{const[e,t]=(0,n.useState)(!1),{totalTicket:a}=_t(),r=jt();return{loading:e,claimRawTicket:(0,n.useCallback)((async()=>{try{t(!0);const e=await r(a);return await window.luckyWheel.provider.sendAll(e.map((e=>{let{tx:t,signers:a}=e;return{tx:t,signers:a}})),{commitment:"finalized",preflightCommitment:"finalized"}),window.notify({type:"success",description:"Redeemed tickets successfully."})}catch(e){return p(e)}finally{t(!1)}}),[r,a])}})(),c=(0,n.useMemo)((()=>{const e=[{type:b.GoodLuck,rewardAddress:b.GoodLuck}];for(const a in t){const{rewardType:n}=t[a];let r=b.Token;n.nftCollection&&(r=b.NFT),n.ticket&&(r=b.Ticket),e.push({type:r,rewardAddress:a})}return e}),[t]);return(0,h.jsxs)(l.Row,{gutter:[16,16],justify:"center",children:[(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(Zt,{rewards:c})}),(0,h.jsx)(l.Col,{span:24,className:"remaining-ticket",children:(0,h.jsx)(l.Row,{justify:"center",children:(0,h.jsx)(l.Col,{xs:24,sm:20,md:18,lg:16,children:(0,h.jsxs)(l.Row,{justify:"space-between",wrap:!1,align:"middle",children:[(0,h.jsx)(l.Col,{children:(0,h.jsxs)(l.Space,{size:4,direction:"vertical",children:[(0,h.jsxs)(l.Space,{className:"space-middle-icon",children:[(0,h.jsx)(l.Typography.Text,{children:"Remaining tickets:"}),(0,h.jsx)(l.Typography.Title,{level:5,className:"gradient-text",children:Object.keys(a).length}),(0,h.jsx)(yt.Z,{style:{fontSize:20},component:Ut})]}),(!!r||s)&&(0,h.jsxs)(l.Space,{size:0,children:[(0,h.jsxs)(l.Typography.Text,{children:["You have ",r," bonus tickets"]}),(0,h.jsx)(l.Button,{type:"text",onClick:i,loading:s,children:"Claim"})]})]})}),(0,h.jsx)(l.Col,{children:(0,h.jsx)(l.Divider,{type:"vertical",style:{borderColor:"#4E4F5C",height:24}})}),(0,h.jsx)(l.Col,{children:(0,h.jsx)(l.Button,{onClick:()=>window.open("https://hub.sentre.io/app/any_arts?autoInstall=true"),style:{marginLeft:-12},type:"text",children:"Get more ticket"})})]})})})})]})});var Jt=a(32083);const qt=()=>{const[e,t]=(0,n.useState)(!1),a=M(),{getPrizeAmountTickets:r}=V(a),i=(0,Jt.G)(),l=(0,s.useGetMintDecimals)();return{calculateTotalRewards:(0,n.useCallback)((async()=>{try{t(!0);const e=await r();let a=[];const n={};for(const t in e){const r=e[t];if(!r)continue;let s=0;for(const e in r){const t=r[e],a=n[e]||{};let c=a.decimals,o=a.mintPrice;c||o||(c=await l({mintAddress:e})||0,o=await i(e)||0,n[e]=Object.assign({...n[e]},{[e]:{decimals:c,mintPrice:o}})),o&&(s+=o*Number(Fe.utilsBN.undecimalize(t,c)))}a.push({authority:t,total:s})}return a.sort(((e,t)=>t.total-e.total)).map(((e,t)=>{let{authority:a,total:n}=e;return{authority:a,total:n,index:t}}))}catch(e){return[]}finally{t(!1)}}),[l,i,r]),loading:e}};const Xt=a.p+"static/media/rank-1.351bf77a1e7abb036ecbcf1014a21ae1.svg";const Qt=a.p+"static/media/rank-2.bfe0ae8b10f4dcb3c1c54dee79d5d5c6.svg";const ea=a.p+"static/media/rank-3.edf1dbbe5ead0149352eecf616eebf48.svg",ta=()=>{const[e,t]=(0,n.useState)([]),{calculateTotalRewards:a,loading:r}=qt(),i=(0,s.useWalletAddress)(),c=[{title:"NO.",dataIndex:"index",render:e=>(e=>{switch(e){case 1:return(0,h.jsx)(l.Image,{src:Xt,preview:!1});case 2:return(0,h.jsx)(l.Image,{src:Qt,preview:!1});case 3:return(0,h.jsx)(l.Image,{src:ea,preview:!1});default:return(0,h.jsx)(l.Typography.Text,{children:e})}})(e+1)},{title:"WALLET ADDRESS",dataIndex:"authority",key:"authority",render:e=>(0,h.jsx)(l.Typography.Text,{className:e===i?"owner":"",children:s.util.shortenAddress(e)})},{title:"PRIZE",dataIndex:"total",key:"total",render:e=>(0,h.jsx)(l.Typography.Text,{children:s.util.numeric(e).format("0,0.[000]a$")})}];return(0,n.useEffect)((()=>{(async()=>{const e=await a();console.log(e,"rewards");let n=0;for(const{total:t}of e)n+=t;console.log(n,"total");const r=[...e].splice(0,10),s=e.find((e=>{let{authority:t}=e;return t===i}));s&&s.index>10&&r.push({...s}),t(r)})()}),[a,i]),(0,h.jsx)(l.Table,{dataSource:e,columns:c,pagination:!1,rowKey:e=>e.authority,loading:r,className:"center-index"})},aa=e=>{const t=(0,r.useSelector)((e=>e.lotteryInfos)),a=(0,s.useWalletAddress)(),i=(0,n.useMemo)((()=>({authority:new d.web3.PublicKey(a),campaign:new d.web3.PublicKey(e),totalPicked:new d.BN(0),totalClaimed:new d.BN(0)})),[e,a]),l=(0,n.useCallback)((()=>Object.values(t).find((t=>t.campaign.toBase58()===e&&t.authority.toBase58()===a))||i),[i,e,t,a]);return{getListLotteryData:(0,n.useCallback)((()=>Object.values(t).filter((t=>t.campaign.toBase58()===e))||[i]),[i,e,t]),getLotteryOwnerData:l}},na=()=>{const e=M(),{getListLotteryData:t}=aa(e),a=t(),r=(0,n.useMemo)((()=>{a.sort(((e,t)=>t.totalPicked.toNumber()-e.totalPicked.toNumber()));const e=[];let t=0;for(const{authority:n,totalPicked:r}of a){if(e.length>=10)break;t++,e.push({index:t,authority:n.toBase58(),totalPicked:r.toNumber()})}return e}),[a]),i=[{title:"NO.",dataIndex:"index",render:e=>(e=>{if(!e)return 0;switch(e){case 1:return(0,h.jsx)(l.Image,{src:Xt,preview:!1});case 2:return(0,h.jsx)(l.Image,{src:Qt,preview:!1});case 3:return(0,h.jsx)(l.Image,{src:ea,preview:!1});default:return(0,h.jsx)(l.Typography.Text,{children:e})}})(e)},{title:"WALLLET ADDRESS",dataIndex:"authority",key:"authority",render:e=>(0,h.jsx)(l.Typography.Text,{children:s.util.shortenAddress(e)})},{title:"Spin",dataIndex:"totalPicked",key:"totalPicked",render:e=>(0,h.jsx)(l.Typography.Text,{children:e})}];return(0,h.jsx)(l.Table,{dataSource:r,columns:i,pagination:!1,rowKey:e=>e.authority,className:"center-index"})};var ra;!function(e){e.prize="Top prize",e.spin="Top spin"}(ra||(ra={}));const sa=()=>(0,h.jsx)(l.Row,{gutter:[12,12],children:(0,h.jsx)(l.Col,{span:24,children:(0,h.jsxs)(l.Tabs,{defaultActiveKey:ra.prize,className:"tabs-leader-board",size:"large",children:[(0,h.jsx)(l.Tabs.TabPane,{tab:ra.prize,children:(0,h.jsx)(ta,{})},ra.prize),(0,h.jsx)(l.Tabs.TabPane,{tab:ra.spin,children:(0,h.jsx)(na,{})},ra.spin)]})})}),ia=e=>{let{tabId:t}=e;return t===T.Reward?(0,h.jsx)(bt,{}):t===T.LeaderBoard?(0,h.jsx)(sa,{}):t===T.Spin?(0,h.jsx)($t,{}):(0,h.jsx)(n.Fragment,{})},la=e=>{let{children:t}=e;return(0,h.jsx)(l.Row,{justify:"center",align:"middle",children:(0,h.jsx)(l.Col,{xs:24,md:16,lg:12,children:(0,h.jsx)(l.Col,{span:24,children:t})})})};var ca=a(29981);const oa=()=>{const e=M(),{getLotteryOwnerData:t}=aa(e),a=t();return(0,h.jsxs)(l.Space,{size:4,className:"remaining-ticket space-middle-icon",children:[(0,h.jsx)(l.Typography.Text,{children:"Total spins:"}),(0,h.jsx)(l.Typography.Title,{level:5,className:"gradient-text",children:a.totalPicked.toNumber()}),(0,h.jsx)(yt.Z,{style:{fontSize:20},component:Ut})]})},da=e=>{let{rewardAddress:t="",size:a=64,style:n,children:r}=e;return(0,h.jsxs)("div",{className:"card-reward",style:{width:a+8,height:a+8,...n},children:[(0,h.jsx)("div",{className:"card-reward-child",style:{width:a,height:a},children:r||(0,h.jsx)(ae,{rewardAddress:t,size:a,isChallenge:!0})}),(0,h.jsx)("div",{className:"card-reward-balloons",children:(0,h.jsx)("div",{className:"card-reward-glossy"})})]})},ua=e=>{let{rewardAddresses:t,size:a=64,max:n=2}=e;const r=[...t].splice(0,n),s=t.length-n;return(0,h.jsxs)(l.Space,{className:"card-avatar-reward",direction:"vertical",align:"center",children:[(0,h.jsx)(l.Space,{style:{minHeight:64,justifyContent:"end"},direction:"vertical",align:"center",children:r.map(((e,t)=>(0,h.jsxs)(l.Typography.Title,{level:4,children:[t>0&&"+ ",(0,h.jsx)(X,{rewardAddress:e,isChallenge:!0})," ",(0,h.jsx)(se,{rewardAddress:e,isChallenge:!0})]},e)))}),(0,h.jsxs)("div",{className:"group-reward-avatar",children:[r.map(((e,t)=>{const n=t?-.4*a:0;return(0,h.jsx)(da,{rewardAddress:e,style:{zIndex:99-t,marginLeft:n},size:a},t)})),s>0&&(0,h.jsx)(da,{style:{zIndex:1,marginLeft:-.4*a},size:a,children:(0,h.jsxs)(l.Typography.Title,{level:3,children:["+",s]})})]})]})},pa=()=>{const e=(0,r.useSelector)((e=>e.challengeReceipts)),t=M(),a=it(t),s=(0,n.useCallback)((async t=>{const{mint:n}=a[t],{challengeRewardReceipt:r}=await window.luckyWheel.deriveChallengeRewardPDAs(new d.web3.PublicKey(t),n);return Object.keys(e).includes(r.toBase58())}),[e,a]);return{challengeReceipts:e,checkExistedReceipt:s}};const ha=a.p+"static/media/gift01.3d60c32730a50d61bb1c42728df04322.svg",wa=e=>{let{amount:t,active:a,nextMilestone:i,size:c=64}=e;const[o,u]=(0,n.useState)(!1),w=M(),y=it(w),{checkExistedReceipt:m}=pa(),{onClaimChallengeReward:x,loading:g}=(()=>{const[e,t]=(0,n.useState)(!1),a=M(),{checkExistedReceipt:r}=pa(),i=it(a),l=Ve(),c=(0,n.useCallback)((async e=>{const{mint:t}=i[e],{challengeRewardTreasurer:a}=await window.luckyWheel.deriveChallengeRewardPDAs(new d.web3.PublicKey(e),t),{value:n}=await s.splt.connection.getTokenAccountsByOwner(a,{programId:s.splt.spltProgramId});for(const r of n){const e=s.splt.parseAccountData(r.account.data);if(Number(e.amount.toString())>0)return new d.web3.PublicKey(e.mint)}throw new Error("Can't find account")}),[i]);return{onClaimChallengeReward:(0,n.useCallback)((async e=>{try{t(!0);const a=[];for(const t of e){if(await r(t))continue;const{mint:e,rewardType:n,amount:s}=i[t],o=(await l(t)).find((t=>{let{mint:a}=t;return a===e.toBase58()}));if(!o||Number(o.amount)<s.toNumber())return window.notify({type:"warning",description:"The reward has expired, contact admin to deposit more"});let u=e;n.nftCollection&&(u=await c(t));const p=new d.web3.Transaction,{tx:h}=await window.luckyWheel.claimChallengeReward({challengeReward:new d.web3.PublicKey(t),rewardMint:u,sendAndConfirm:!1});p.add(h),a.push(p)}return await window.luckyWheel.provider.sendAll(a.map((e=>({tx:e})))),window.notify({type:"success",description:"Claimed reward successfully!"})}catch(a){p(a)}finally{t(!1)}}),[i,r,l,c]),loading:e}})(),j=(0,r.useDispatch)(),C=(0,n.useMemo)((()=>{const e=[];for(const a in y){const{totalPicked:n}=y[a];n.toNumber()===t&&e.push(a)}return e}),[t,y]),f=(0,n.useCallback)((()=>a?x(C):j(z({tabId:T.Spin}))),[a,j,C,x]),b=(0,n.useCallback)((async()=>{for(const e of C){const t=await m(e);if(!t)return u(t)}return u(!0)}),[m,C]);(0,n.useEffect)((()=>{b()}),[b]);const k=a?"card-gift active":"card-gift",A=a?"primary":"text",S=o?"card-gift-btn claimed-btn":"card-gift-btn",R=(0,n.useMemo)((()=>o?v.Claimed:a?v.Ready:v.Pending),[a,o]);return(0,h.jsxs)("div",{className:k,children:[(0,h.jsxs)("div",{className:"card-gift-item",children:[(0,h.jsx)(ua,{rewardAddresses:C,size:c}),(0,h.jsx)(l.Image,{src:ha,preview:!1})]}),(0,h.jsx)("div",{className:"gift-step-icon",children:t}),(0,h.jsx)("div",{className:S,children:(a||o||i)&&(0,h.jsx)(l.Button,{disabled:o,type:A,onClick:f,ghost:o,loading:g,children:R})})]})},ya=()=>{var e;const t=M(),a=it(t),n=Object.values(a).sort(((e,t)=>e.totalPicked.toNumber()>t.totalPicked.toNumber()?1:-1)),r=(null===(e=n[n.length-1])||void 0===e?void 0:e.totalPicked.toNumber())||0;return{challengePecrent:100/(r+10),totalChallenge:r}},ma=e=>{const t=it(e);return{getMilestoneCampaign:(0,n.useCallback)((()=>{const e=[];for(const a in t){const n=t[a].totalPicked;e.findIndex((e=>e.eq(n)))>=0||e.push(n)}return e.sort(((e,t)=>e.toNumber()-t.toNumber())),e}),[t])}},xa=()=>{const e=M(),{getLotteryOwnerData:t}=aa(e),{challengePecrent:a}=ya(),r=(0,s.useInfix)(),i=t(),{getMilestoneCampaign:l}=ma(e),c=l(),o=r<s.Infix.lg,d=o?75:150,u=o?38:64,p=(0,n.useMemo)((()=>{const e=i.totalPicked;for(const t of c)if(t.gt(e))return t;return c[0]}),[i.totalPicked,c]);return(0,h.jsx)(n.Fragment,{children:c.map(((e,t)=>{const n=e.toNumber();return(0,h.jsx)("div",{className:"card-challenge-gift",style:{left:`calc(${n*a}% - ${d/2}px)`},children:(0,h.jsx)("div",{style:{minWidth:d},children:(0,h.jsx)(wa,{amount:n,active:e.lte(i.totalPicked),nextMilestone:p===e,size:u})})},t)}))})};var ga;!function(e){e.Horizontal="horizontal",e.Vertical="vertical"}(ga||(ga={}));const ja=e=>{let{direction:t="horizontal",percent:a=0,showInfo:n=!1,style:r,strokeWitdh:s=4,borderRadius:i=s,background:l="#fff",successColor:c="#000",infoStyle:o}=e;const d=t===ga.Vertical?{flexFlow:"column",alignItems:"start",width:s,height:"100%"}:{flexFlow:"row nowrap",alignItems:"center",width:"100%"},u=t===ga.Vertical?{height:"100%",width:s}:{height:s,width:"100%"},p=t===ga.Vertical?{height:`${a}%`,width:"100%"}:{height:"100%",width:`${a}%`};return(0,h.jsxs)("div",{style:{display:"flex",gap:12,...d,...r},children:[(0,h.jsx)("div",{style:{display:"flex",...u,background:l,transition:"all 0.3s ease",borderRadius:i},children:(0,h.jsx)("div",{style:{...p,background:c,transition:"all 0.3s ease",borderRadius:i}})}),n&&(0,h.jsxs)("div",{style:{...o},children:[a,"%"]})]})},Ca=()=>{const e=M(),{challengePecrent:t,totalChallenge:a}=ya(),{getLotteryOwnerData:n}=aa(e),r=(0,s.useInfix)(),i=(0,s.useWidth)(),c=n(),o=r<s.Infix.lg,d=o?"card-challenge mobile-direction":"card-challenge",u=o?12:15,p=u*a<i?"100%":u*a;return(0,h.jsx)(l.Row,{className:"challenge",children:(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(ca.Z,{className:d,children:(0,h.jsxs)(l.Row,{gutter:[0,24],justify:"center",children:[(0,h.jsx)(l.Col,{className:"scroll-challenge",span:24,children:(0,h.jsxs)(l.Row,{className:"inner-challenge-progress",style:{width:p},children:[(0,h.jsx)(l.Col,{className:"challenge-gifts",style:{width:"100%"},children:(0,h.jsx)(xa,{})}),(0,h.jsx)(l.Col,{className:"challenge-progress",style:{width:"100%"},children:(0,h.jsx)(ja,{percent:c.totalPicked.toNumber()*t,strokeWitdh:12,background:"#212433",successColor:"linear-gradient(84.24deg, #9945FF 0%, #B9F8FD 100%)"})})]})}),(0,h.jsx)(l.Col,{className:"challenge-action",children:(0,h.jsx)(oa,{})})]})})})})};var fa=a(44633),ba=a(10240),ka=a(2582);const Ta=e=>{let{perViews:t=1,spacing:a=0,speed:n=9e3,children:r}=e;return(0,h.jsx)(ba.tq,{modules:[ka.pt,ka.oM],slidesPerView:t,spaceBetween:a,autoplay:{delay:0,disableOnInteraction:!1,reverseDirection:!1},speed:n,loop:!0,className:"apps-slide-infinite",children:r})},va=["#B9F8FD","#708FFF","#A0E86F","#FF9470","#FFD970"],Aa=e=>{let{value:t=new d.BN(0)}=e;const a=M(),{getMilestoneCampaign:r}=ma(a),s=r(),i=(0,n.useCallback)((()=>{let e=0;for(const a of s){if(!t.cmp(a))break;e++}return va[e>va.length-1?va.length-1:e]}),[s,t])();return(0,h.jsx)(l.Tag,{style:{color:i,background:`${i}33`,margin:0,border:"none"},children:t.toNumber()})},Sa=e=>{let{authority:t,rewardAddress:a,milestone:n}=e;return!a||n?(0,h.jsxs)(l.Space,{size:6,children:[(0,h.jsx)(l.Typography.Text,{children:s.util.shortenAddress(t)}),(0,h.jsx)(l.Typography.Text,{type:"secondary",children:"reached"}),(0,h.jsx)(Aa,{value:n}),(0,h.jsx)(l.Typography.Text,{type:"secondary",children:"milestone!"})]}):(0,h.jsxs)(l.Space,{size:6,children:[(0,h.jsx)(l.Typography.Text,{children:s.util.shortenAddress(t)}),(0,h.jsx)(l.Typography.Text,{type:"secondary",children:"won"}),(0,h.jsxs)(l.Typography.Text,{style:{color:"#B67AFF"},children:[(0,h.jsx)(X,{rewardAddress:a})," ",(0,h.jsx)(se,{rewardAddress:a})]})]})},Ra=e=>{let{data:t=[],height:a=240}=e;const n=M(),r=H(n);return(0,h.jsx)(Ta,{spacing:24,speed:12e3,children:!!Object.keys(r).length&&t.map(((e,t)=>{let{authority:n,rewardAddress:r,milestone:s}=e;return(0,h.jsx)(ba.o5,{style:{height:a},children:(0,h.jsx)(Sa,{authority:n,rewardAddress:r,milestone:s})},t)}))})},Na=()=>{const e=(()=>{const[e,t]=(0,n.useState)(0),[a,r]=(0,n.useState)({}),s=(0,n.useCallback)((async()=>{if(e)return;const n=JSON.parse(JSON.stringify(a)),{provider:s,program:i}=window.luckyWheel,l=s.connection.onProgramAccountChange(i.account.ticket.programId,(async e=>{const t=e.accountId.toBase58(),a=e.accountInfo.data,r=i.coder.accounts.decode("ticket",a);n[t]=r}),"confirmed",[{memcmp:{bytes:(0,Fe.encodeIxData)([3]),offset:121}}]);return t(l),r(n)}),[a,e]);return(0,n.useEffect)((()=>{if(!e)return s(),()=>{(async()=>{e&&(await window.luckyWheel.provider.connection.removeProgramAccountChangeListener(e),t(0))})()}}),[s,e]),{...a}})(),t=M(),a=(()=>{const[e,t]=(0,n.useState)(0),[a,r]=(0,n.useState)({}),s=(0,n.useCallback)((async()=>{if(e)return;const n=JSON.parse(JSON.stringify(a)),{provider:s,program:i}=window.luckyWheel,l=s.connection.onProgramAccountChange(i.account.ticket.programId,(async e=>{const t=e.accountId.toBase58(),a=e.accountInfo.data,r=i.coder.accounts.decode("lotteryInfo",a);n[t]=r}),"confirmed",[{memcmp:{offset:0,bytes:(0,Fe.encodeIxData)((0,Fe.accountDiscriminator)("lotteryInfo"))}}]);return t(l),r(n)}),[a,e]);return(0,n.useEffect)((()=>{if(!e)return s(),()=>{(async()=>{e&&(await window.luckyWheel.provider.connection.removeProgramAccountChangeListener(e),t(0))})()}}),[s,e]),{...a}})(),{getMilestoneCampaign:r}=ma(t),s=r(),i=(0,n.useCallback)((e=>{for(const t of s)if(!t.cmp(e))return!0;return!1}),[s]),c=(0,n.useMemo)((()=>{const t=Object.values(e),a=t.length;if(!a)return[];let n=t;return a>=4&&(n=t.slice(a-3,a)),n.map((e=>{let{authority:t,reward:a}=e;return{authority:t.toBase58(),rewardAddress:a.toBase58()}}))}),[e]),o=(0,n.useMemo)((()=>{const e=Object.values(a);if(!e.length)return[];let t=[];for(const a of e)i(a.totalPicked)&&t.push(a);return t.length>=4&&(t=e.slice(t.length-3,t.length)),t.map((e=>{let{authority:t,totalPicked:a}=e;return{authority:t.toBase58(),milestone:a}}))}),[i,a]);return c.length||o.length?(0,h.jsx)(l.Card,{bordered:!1,style:{borderRadius:50,backdropFilter:" blur(96px)"},bodyStyle:{padding:8},children:(0,h.jsxs)(l.Row,{gutter:[8,8],wrap:!1,children:[(0,h.jsx)(l.Col,{children:(0,h.jsx)(fa.Z,{name:"Global"})}),(0,h.jsx)(l.Col,{flex:"auto",children:(0,h.jsx)(Ra,{data:[...c,...o],height:"auto"})})]})}):null},Pa="11111111111111111111111111111111",Ba=()=>{const[e,t]=(0,n.useState)(),[a,i]=(0,n.useState)(!1),c=(e=>{const t=(0,r.useSelector)((e=>e.tickets)),a=(0,s.useWalletAddress)();return(0,n.useCallback)((async()=>{const n=Object.keys(t).map((e=>new d.web3.PublicKey(e))),r=await(0,Fe.getMultipleAccounts)(window.luckyWheel.provider.connection,n),s={};for(const i of r){if(!i)continue;const n=i.publicKey.toBase58(),r=t[n],{authority:l,campaign:c}=r;l.toBase58()===a&&c.toBase58()===e&&r.state.lost&&(s[n]=r)}return s}),[e,t,a])})(M()),{closeTickets:o,loading:u}=(()=>{const[e,t]=(0,n.useState)(!1);return{closeTickets:(0,n.useCallback)((async e=>{try{t(!0);const a=[];let n=7;for(let t=0;t<e.length;t+=n){const r=new d.web3.Transaction;(t+n>e.length||n>e.length)&&(n=e.length-t),e.slice(t,t+n).forEach((async e=>{const{tx:t}=await window.luckyWheel.closeTicket({ticket:new d.web3.PublicKey(e),sendAndConfirm:!1});r.add(t)})),a.push(r)}return await window.luckyWheel.provider.sendAll(a.map((e=>({tx:e})))),window.notify({type:"success",description:"Claimed reward successfully!"})}catch(a){p(a)}finally{t(!1)}}),[]),loading:e}})();(0,n.useEffect)((()=>{(async()=>{if(e)return;const a=await c();t(a)})()}),[c,e]),(0,n.useEffect)((()=>{e&&!a&&Object.keys(e).length>=15&&i(!0)}),[e,a]);return(0,h.jsxs)(l.Modal,{visible:a,onCancel:()=>i(!1),footer:null,closeIcon:(0,h.jsx)(ie.default,{name:"close-outline"}),className:"congrats",children:[(0,h.jsx)(l.Image,{preview:!1,src:Nt,style:{borderRadius:16}}),(0,h.jsxs)(l.Row,{gutter:[16,16],className:"congrats_content",children:[(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(l.Typography.Title,{level:4,className:"gradient-text",children:"Congratulations!"})}),(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(l.Typography.Text,{children:"You are the lucky player who received a reward from the system."})}),(0,h.jsx)(l.Col,{span:24})," ",(0,h.jsx)(l.Col,{span:24,children:(0,h.jsxs)(l.Space,{size:16,direction:"vertical",children:[(0,h.jsx)(Q.Z,{size:96,mintAddress:Pa}),(0,h.jsxs)(l.Typography.Title,{level:3,children:[s.util.numeric(.00174*Object.keys(e||{}).length).format("0,0[00000]")," ",(0,h.jsx)(re.Z,{mintAddress:Pa})]})]})}),(0,h.jsx)(l.Col,{span:24})," ",(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(l.Button,{size:"large",block:!0,type:"primary",onClick:async()=>{if(e)return await o(Object.keys(e)),t({}),i(!1)},loading:u,children:"CLAIM"})})]})]})};var Ia,Fa,za,La,Ma;function Ea(){return Ea=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},Ea.apply(this,arguments)}function Da(e,t){let{title:a,titleId:r,...s}=e;return n.createElement("svg",Ea({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":r},s),a?n.createElement("title",{id:r},a):null,Ia||(Ia=n.createElement("path",{d:"M7.03 3.17C7.02 3.08 7.01 3 6.99 2.91C6.98 2.84 6.97 2.77 6.95 2.69C6.92 2.57 6.88 2.44 6.83 2.32C6.71 1.97 6.53 1.65 6.3 1.35C6.17 1.19 6.03 1.03 5.87 0.9C5.23 0.32 4.4 0 3.53 0C1.58 0 0 1.58 0 3.53C0 4.4 0.32 5.23 0.9 5.87C1.03 6.03 1.19 6.17 1.35 6.3C1.65 6.53 1.97 6.71 2.32 6.83C2.44 6.88 2.57 6.92 2.69 6.95C2.77 6.97 2.84 6.98 2.91 6.99C3 7.01 3.08 7.02 3.17 7.03C3.29 7.04 3.41 7.05 3.53 7.05C5.47 7.05 7.05 5.47 7.05 3.53C7.05 3.41 7.04 3.29 7.03 3.17Z",fill:"#B67AFF"})),Fa||(Fa=n.createElement("path",{d:"M19.0992 14.1402C18.9992 14.0102 18.8692 13.8802 18.7292 13.7702C18.7092 13.7502 18.6792 13.7202 18.6492 13.7002C18.3792 13.4902 18.0792 13.3202 17.7692 13.2002C17.7392 13.1802 17.7092 13.1702 17.6792 13.1702C17.5692 13.1302 17.4592 13.0902 17.3492 13.0602C17.1792 13.0202 16.9992 12.9902 16.8292 12.9702C16.7092 12.9602 16.5892 12.9502 16.4692 12.9502C14.5292 12.9502 12.9492 14.5302 12.9492 16.4702C12.9492 16.5902 12.9592 16.7102 12.9692 16.8302C12.9892 17.0002 13.0192 17.1802 13.0592 17.3502C13.0892 17.4602 13.1292 17.5702 13.1692 17.6802C13.1692 17.7102 13.1792 17.7402 13.1992 17.7702C13.3192 18.0802 13.4892 18.3802 13.6992 18.6502C13.7192 18.6802 13.7492 18.7002 13.7692 18.7302C13.8792 18.8702 14.0092 19.0002 14.1392 19.1002C14.7792 19.6802 15.5992 20.0002 16.4692 20.0002C18.4192 20.0002 19.9992 18.4202 19.9992 16.4702C19.9992 15.6002 19.6792 14.7802 19.0992 14.1402Z",fill:"#B67AFF"})),za||(za=n.createElement("path",{d:"M3.53 12.9502C3.41 12.9502 3.29 12.9602 3.17 12.9702C3 12.9902 2.82 13.0202 2.65 13.0602C2.54 13.0902 2.43 13.1302 2.32 13.1702C2.29 13.1702 2.26 13.1802 2.23 13.2002C1.92 13.3202 1.62 13.4902 1.35 13.7002C1.32 13.7202 1.3 13.7502 1.27 13.7702C1.13 13.8802 1 14.0102 0.9 14.1402C0.32 14.7802 0 15.6002 0 16.4702C0 18.4202 1.58 20.0002 3.53 20.0002C4.4 20.0002 5.23 19.6802 5.87 19.1002C6.03 18.9702 6.17 18.8102 6.3 18.6502C6.51 18.3802 6.68 18.0802 6.8 17.7702C6.82 17.7402 6.83 17.7102 6.83 17.6802C6.87 17.5702 6.91 17.4602 6.94 17.3502C6.98 17.1802 7.01 17.0002 7.03 16.8302C7.04 16.7102 7.05 16.5902 7.05 16.4702C7.05 14.5302 5.47 12.9502 3.53 12.9502Z",fill:"#B67AFF"})),La||(La=n.createElement("path",{d:"M16.4692 0C15.5992 0 14.7792 0.32 14.1392 0.9C14.0092 1 13.8792 1.13 13.7692 1.27C13.7492 1.29 13.7192 1.32 13.6992 1.35C13.4892 1.62 13.3192 1.92 13.1992 2.23C13.1792 2.26 13.1692 2.29 13.1692 2.32C13.1292 2.43 13.0892 2.54 13.0592 2.65C13.0192 2.82 12.9892 3 12.9692 3.17C12.9592 3.29 12.9492 3.41 12.9492 3.53C12.9492 5.47 14.5292 7.05 16.4692 7.05C16.5892 7.05 16.7092 7.04 16.8292 7.03C16.9992 7.01 17.1792 6.98 17.3492 6.94C17.4592 6.91 17.5692 6.87 17.6792 6.83C17.7092 6.83 17.7392 6.82 17.7692 6.8C18.0792 6.68 18.3792 6.51 18.6492 6.3C18.8092 6.17 18.9692 6.03 19.0992 5.87C19.6792 5.23 19.9992 4.4 19.9992 3.53C19.9992 1.58 18.4192 0 16.4692 0Z",fill:"#B67AFF"})),Ma||(Ma=n.createElement("path",{d:"M13.77 18.73C13.75 18.7 13.72 18.68 13.7 18.65C13.49 18.38 13.32 18.08 13.2 17.77C13.21 17.8 13.22 17.83 13.23 17.86C11.22 18.7 8.82 18.71 6.77 17.86C6.78 17.83 6.79 17.8 6.8 17.77C6.68 18.08 6.51 18.38 6.3 18.65C6.17 18.81 6.03 18.97 5.87 19.1C7.15 19.69 8.57 20 10 20C11.46 20 12.85 19.7 14.14 19.1C14.01 19 13.88 18.87 13.77 18.73ZM1.5 10C1.5 8.89 1.72 7.78 2.14 6.77C2.15 6.77 2.17 6.78 2.18 6.78C2.06 6.73 1.93 6.67 1.82 6.61C1.66 6.52 1.5 6.42 1.35 6.3C1.19 6.17 1.03 6.03 0.9 5.87C0.31 7.15 0 8.57 0 10C0 11.46 0.3 12.85 0.9 14.14C1 14.01 1.13 13.88 1.27 13.77C1.3 13.75 1.32 13.72 1.35 13.7C1.62 13.49 1.92 13.32 2.23 13.2C2.2 13.21 2.17 13.22 2.14 13.23C1.71 12.22 1.5 11.13 1.5 10ZM19.1 5.87C18.97 6.03 18.81 6.17 18.65 6.3C18.38 6.51 18.08 6.68 17.77 6.8C17.8 6.79 17.83 6.78 17.86 6.77C18.28 7.78 18.5 8.89 18.5 10C18.5 11.13 18.29 12.22 17.86 13.23C17.83 13.22 17.8 13.21 17.77 13.2C18.08 13.32 18.38 13.49 18.65 13.7C18.68 13.72 18.71 13.75 18.73 13.77C18.87 13.88 19 14.01 19.1 14.14C19.7 12.85 20 11.46 20 10C20 8.57 19.69 7.15 19.1 5.87ZM10 0C8.57 0 7.15 0.31 5.87 0.9C6.03 1.03 6.17 1.19 6.3 1.35C6.42 1.5 6.52 1.66 6.61 1.82C6.67 1.93 6.73 2.06 6.78 2.18C6.78 2.17 6.77 2.15 6.77 2.14C8.81 1.29 11.22 1.3 13.23 2.14C13.22 2.17 13.21 2.2 13.2 2.23C13.32 1.92 13.49 1.62 13.7 1.35C13.72 1.32 13.75 1.29 13.77 1.27C13.88 1.13 14.01 1 14.14 0.9C12.85 0.3 11.46 0 10 0Z",fill:"#B9F8FD"})))}const Oa=n.forwardRef(Da);a.p;var Wa,Ka,Za,_a,Ha;function Va(){return Va=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},Va.apply(this,arguments)}function Ya(e,t){let{title:a,titleId:r,...s}=e;return n.createElement("svg",Va({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":r},s),a?n.createElement("title",{id:r},a):null,Wa||(Wa=n.createElement("path",{d:"M17.9707 8V16C17.9707 19 16.9707 20 13.9707 20H5.9707C2.9707 20 1.9707 19 1.9707 16V8H17.9707Z",fill:"#B9F8FD"})),Ka||(Ka=n.createElement("path",{d:"M19.5 5V6C19.5 7.1 18.97 8 17.5 8H2.5C0.97 8 0.5 7.1 0.5 6V5C0.5 3.9 0.97 3 2.5 3H17.5C18.97 3 19.5 3.9 19.5 5Z",fill:"#B67AFF"})),Za||(Za=n.createElement("path",{d:"M9.64076 2.99994H4.12076C3.78076 2.62994 3.79076 2.05994 4.15076 1.69994L5.57076 0.279941C5.94076 -0.0900586 6.55076 -0.0900586 6.92076 0.279941L9.64076 2.99994Z",fill:"#B67AFF"})),_a||(_a=n.createElement("path",{d:"M15.8696 2.99994H10.3496L13.0696 0.279941C13.4396 -0.0900586 14.0496 -0.0900586 14.4196 0.279941L15.8396 1.69994C16.1996 2.05994 16.2096 2.62994 15.8696 2.99994Z",fill:"#B67AFF"})),Ha||(Ha=n.createElement("path",{d:"M6.93945 8V13.14C6.93945 13.94 7.81945 14.41 8.48945 13.98L9.42945 13.36C9.76945 13.14 10.1995 13.14 10.5295 13.36L11.4195 13.96C12.0795 14.4 12.9695 13.93 12.9695 13.13V8H6.93945Z",fill:"#B67AFF"})))}const Ga=n.forwardRef(Ya);a.p;var Ua,$a,Ja;function qa(){return qa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},qa.apply(this,arguments)}function Xa(e,t){let{title:a,titleId:r,...s}=e;return n.createElement("svg",qa({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":r},s),a?n.createElement("title",{id:r},a):null,Ua||(Ua=n.createElement("path",{d:"M16.9869 7.05346C16.9869 8.51454 16.5577 9.85471 15.8193 10.9732C14.7415 12.5854 13.035 13.724 11.0491 14.0162C10.7098 14.0767 10.3605 14.1069 10.0012 14.1069C9.64198 14.1069 9.2927 14.0767 8.9534 14.0162C6.96749 13.724 5.261 12.5854 4.18322 10.9732C3.44474 9.85471 3.01562 8.51454 3.01562 7.05346C3.01562 3.15391 6.13919 0 10.0012 0C13.8633 0 16.9869 3.15391 16.9869 7.05346Z",fill:"#B9F8FD"})),$a||($a=n.createElement("path",{d:"M19.231 16.5955L17.5844 16.9884C17.2151 17.0791 16.9257 17.3613 16.8459 17.7341L16.4966 19.2153C16.307 20.0214 15.2891 20.2633 14.7602 19.6285L10 14.1066L5.2398 19.6385C4.71089 20.2733 3.69298 20.0315 3.50337 19.2254L3.15409 17.7441C3.06428 17.3713 2.77487 17.0791 2.41561 16.9985L0.769003 16.6055C0.0105648 16.4242 -0.258881 15.4669 0.28999 14.9127L4.18198 10.9829C5.25976 12.5951 6.96625 13.7338 8.95216 14.026C9.29146 14.0865 9.64074 14.1167 10 14.1167C10.3593 14.1167 10.7085 14.0865 11.0478 14.026C13.0338 13.7338 14.7402 12.5951 15.818 10.9829L19.71 14.9127C20.2589 15.4568 19.9894 16.4141 19.231 16.5955Z",fill:"#B67AFF"})),Ja||(Ja=n.createElement("path",{d:"M10.5798 4.01052L11.1686 5.19953C11.2484 5.36075 11.458 5.52198 11.6476 5.55221L12.7154 5.73357C13.394 5.84441 13.5537 6.34824 13.0647 6.84198L12.2364 7.67831C12.0967 7.81938 12.0168 8.09145 12.0667 8.29298L12.3062 9.33085C12.4958 10.147 12.0667 10.4695 11.3482 10.0362L10.3503 9.44167C10.1706 9.33083 9.87124 9.33083 9.69161 9.44167L8.69367 10.0362C7.97515 10.4594 7.54603 10.147 7.73564 9.33085L7.97515 8.29298C8.01506 8.10153 7.94521 7.81938 7.8055 7.67831L6.9772 6.84198C6.48821 6.34824 6.64788 5.85449 7.32648 5.73357L8.39428 5.55221C8.57391 5.52198 8.78348 5.36075 8.86332 5.19953L9.45211 4.01052C9.74151 3.36563 10.2604 3.36563 10.5798 4.01052Z",fill:"#B67AFF"})))}const Qa=n.forwardRef(Xa);a.p;var en,tn,an,nn;function rn(){return rn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},rn.apply(this,arguments)}function sn(e,t){let{title:a,titleId:r,...s}=e;return n.createElement("svg",rn({width:21,height:20,viewBox:"0 0 21 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":r},s),a?n.createElement("title",{id:r},a):null,en||(en=n.createElement("path",{d:"M7.16997 12.2734H2.49999C1.4 12.2734 0.5 13.1427 0.5 14.2051V20.0001H7.16997V12.2734Z",fill:"#B9F8FD"})),tn||(tn=n.createElement("path",{d:"M11.8301 8.41016H9.16015C8.06015 8.41016 7.16016 9.27941 7.16016 10.3418V20.0001H13.8301V10.3418C13.8301 9.27941 12.9401 8.41016 11.8301 8.41016Z",fill:"#B67AFF"})),an||(an=n.createElement("path",{d:"M18.5001 15.1709H13.8301V20.0001H20.5001V17.1026C20.5001 16.0401 19.6001 15.1709 18.5001 15.1709Z",fill:"#B9F8FD"})),nn||(nn=n.createElement("path",{d:"M13.5097 3.43596C13.8197 3.13655 13.9397 2.7792 13.8397 2.47013C13.7397 2.16106 13.4297 1.93893 12.9897 1.87132L12.0297 1.71678C11.9897 1.70712 11.8997 1.64916 11.8797 1.61052L11.3497 0.586743C10.9497 -0.195581 10.0397 -0.195581 9.63967 0.586743L9.10968 1.61052C9.08968 1.64916 8.99968 1.70712 8.95968 1.71678L7.99968 1.87132C7.55968 1.93893 7.25969 2.16106 7.14969 2.47013C7.04969 2.7792 7.16968 3.13655 7.47968 3.43596L8.21968 4.16034C8.24968 4.18931 8.28968 4.30521 8.27968 4.34385L8.06968 5.2324C7.90968 5.88916 8.16968 6.18857 8.33968 6.31412C8.50968 6.43002 8.87968 6.58457 9.48968 6.23687L10.3897 5.72498C10.4297 5.69601 10.5597 5.69601 10.5997 5.72498L11.4997 6.23687C11.7797 6.40106 12.0097 6.44936 12.1897 6.44936C12.3997 6.44936 12.5497 6.37207 12.6397 6.31412C12.8097 6.19823 13.0697 5.89882 12.9097 5.2324L12.6997 4.34385C12.6897 4.29556 12.7197 4.18931 12.7597 4.16034L13.5097 3.43596Z",fill:"#B67AFF"})))}const ln=n.forwardRef(sn),cn=(a.p,[{label:(0,h.jsxs)(l.Space,{className:"space-middle-icon",children:[(0,h.jsx)(yt.Z,{style:{fontSize:20},component:Oa}),(0,h.jsx)(l.Typography.Text,{children:"Spin"})]}),value:T.Spin},{label:(0,h.jsxs)(l.Space,{className:"space-middle-icon",children:[(0,h.jsx)(yt.Z,{style:{fontSize:20},component:Ga}),(0,h.jsx)(l.Typography.Text,{children:"Reward"})]}),value:T.Reward},{label:(0,h.jsxs)(l.Space,{className:"space-middle-icon",children:[(0,h.jsx)(yt.Z,{style:{fontSize:20},component:Qa}),(0,h.jsx)(l.Typography.Text,{children:"Challenge"})]}),value:T.Challenge},{label:(0,h.jsxs)(l.Space,{className:"space-middle-icon",children:[(0,h.jsx)(yt.Z,{style:{fontSize:20},component:ln}),(0,h.jsx)(l.Typography.Text,{children:"LeaderBoard"})]}),value:T.LeaderBoard}]),on=()=>{const e=(0,r.useSelector)((e=>e.main.tabId)),t=(0,r.useDispatch)();return(0,h.jsxs)(n.Fragment,{children:[(0,h.jsx)(la,{children:(0,h.jsxs)(l.Row,{gutter:[32,32],style:{paddingBottom:24},children:[(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(Na,{})}),(0,h.jsx)(l.Col,{span:24,style:{zIndex:1},children:(0,h.jsx)(l.Segmented,{value:e,onChange:e=>t(z({tabId:e.toString()})),options:cn,size:"large"})}),(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(ia,{tabId:e})})]})}),e===T.Challenge&&(0,h.jsx)(Ca,{}),(0,h.jsx)(Ba,{})]})},dn=e=>{let{children:t,campaignAddress:a}=e;return(0,r.useSelector)((e=>e.campaigns[a]))?(0,h.jsx)(n.Fragment,{children:t}):(0,h.jsx)(l.Row,{justify:"center",children:(0,h.jsx)(l.Col,{children:(0,h.jsx)(l.Result,{status:"403",title:"Not Found Campaign",subTitle:"Sorry, we not found campaign.",extra:(0,h.jsx)(W,{})})})})},un=e=>{let{children:t}=e;const a=(0,s.useWalletAddress)(),[r,i]=(0,n.useState)(!1);return(0,n.useEffect)((()=>{if(r)return;const e=(0,Fe.getAnchorProvider)(s.rpc,a,window.sentre.solana),t=new(Ae())(e,C.sol.programId);window.luckyWheel=t,i(!0)}),[a,r]),r?(0,h.jsx)(n.Fragment,{children:t}):null},pn=()=>(0,h.jsx)("div",{className:"loading-screen",style:{display:"block"},children:(0,h.jsxs)(l.Row,{gutter:[24,24],children:[(0,h.jsx)(l.Col,{span:24,style:{height:256}}),(0,h.jsx)(l.Col,{span:24,children:(0,h.jsx)(l.Row,{gutter:[24,24],justify:"center",children:(0,h.jsx)(l.Col,{children:(0,h.jsxs)(l.Space,{direction:"vertical",align:"center",size:32,children:[(0,h.jsx)(l.Spin,{size:"large"}),(0,h.jsx)(l.Typography.Title,{level:5,children:"Welcome to Sen Lucky Wheel. The application is loading..."})]})})})})]})}),hn="campaigns",wn=(0,f.createAsyncThunk)("campaigns/intCampaign",(async e=>e)),yn=(0,f.createAsyncThunk)("campaigns/upsetCampaign",(async e=>{let{address:t,data:a}=e;if(!le.account.isAddress(t))throw new Error("Invalid campaign address");if(!a)throw new Error("Data is empty");return{[t]:a}})),mn=(0,f.createSlice)({name:hn,initialState:{},reducers:{},extraReducers:e=>{e.addCase(wn.fulfilled,((e,t)=>{let{payload:a}=t;Object.assign(e,a)})).addCase(yn.fulfilled,((e,t)=>{let{payload:a}=t;Object.assign(e,a)}))}}).reducer,xn=e=>{const{program:t,name:a,filter:r,upset:i,init:l}=e,[c,o]=(0,n.useState)(0),u=e.commitment||"confirmed",w=(0,n.useMemo)((()=>new d.web3.Connection(s.rpc,u)),[u]),{accountClient:y}=(0,n.useMemo)((()=>{var e;return{accountClient:null===t||void 0===t||null===(e=t.account)||void 0===e?void 0:e[a]}}),[a,null===t||void 0===t?void 0:t.account]),m=(0,n.useCallback)((async()=>{try{const e=await y.all(r),t={};for(const a of e)t[a.publicKey.toBase58()]=a.account;l(t)}catch(e){p(e)}}),[y,r,l]),x=(0,n.useCallback)((async()=>{if(c)return;const e=w.onProgramAccountChange(y.programId,(async e=>{const n=e.accountId.toBase58(),r=e.accountInfo.data,s=t.coder.accounts.decode(a,r);i(n,s)}),u,[{memcmp:{offset:0,bytes:(0,Fe.encodeIxData)((0,Fe.accountDiscriminator)(a))}},...r]);o(e)}),[y.programId,u,w,r,a,t.coder.accounts,i,c]);return(0,n.useEffect)((()=>{m()}),[m]),(0,n.useEffect)((()=>{if(!c)return x(),()=>{(async()=>{c&&(await w.removeProgramAccountChangeListener(c),o(0))})()}}),[w,x,c]),(0,h.jsx)(n.Fragment,{})},gn=[],jn=()=>{const e=(0,r.useDispatch)(),t=(0,n.useCallback)((t=>e(wn(t))),[e]),a=(0,n.useCallback)(((t,a)=>e(yn({address:t,data:a}))),[e]);return(0,h.jsx)(xn,{program:window.luckyWheel.program,name:"campaign",filter:gn,init:t,upset:a})},Cn=[],fn=()=>{const e=(0,r.useDispatch)(),t=(0,n.useCallback)((t=>e(oe(t))),[e]),a=(0,n.useCallback)(((t,a)=>e(de({address:t,data:a}))),[e]);return(0,h.jsx)(xn,{program:window.luckyWheel.program,name:"reward",filter:Cn,init:t,upset:a})},bn="tickets",kn=(0,f.createAsyncThunk)("tickets/initTickets",(async e=>e)),Tn=(0,f.createAsyncThunk)("tickets/upsetTicket",(async e=>{let{address:t,data:a}=e;if(!le.account.isAddress(t))throw new Error("Invalid reward address");if(!a)throw new Error("Data is empty");return{[t]:a}})),vn=(0,f.createSlice)({name:bn,initialState:{},reducers:{},extraReducers:e=>{e.addCase(kn.fulfilled,((e,t)=>{let{payload:a}=t;return a})).addCase(Tn.fulfilled,((e,t)=>{let{payload:a}=t;Object.assign(e,a)}))}}).reducer,An=()=>{const e=(0,r.useDispatch)(),t=(0,s.useWalletAddress)(),a=(0,n.useCallback)((async t=>e(kn(t))),[e]),i=(0,n.useCallback)(((t,a)=>e(Tn({address:t,data:a}))),[e]),l=(0,n.useMemo)((()=>[{memcmp:{bytes:t,offset:40}}]),[t]);return t?(0,h.jsx)(xn,{program:window.luckyWheel.program,name:"ticket",filter:l,init:a,upset:i,commitment:"finalized"}):null},Sn="lotteryInfo",Rn=(0,f.createAsyncThunk)("lotteryInfo/initLotteryInfo",(async e=>e)),Nn=(0,f.createAsyncThunk)("lotteryInfo/upsetLotteryInfo",(async e=>{let{address:t,data:a}=e;if(!s.util.isAddress(t))throw new Error("Invalid Lottery Info address");if(!a)throw new Error("Data is empty");return{[t]:a}})),Pn=(0,f.createSlice)({name:Sn,initialState:{},reducers:{},extraReducers:e=>{e.addCase(Rn.fulfilled,((e,t)=>{let{payload:a}=t;return a})).addCase(Nn.fulfilled,((e,t)=>{let{payload:a}=t;Object.assign(e,a)}))}}).reducer,Bn=[],In=()=>{const e=(0,r.useDispatch)(),t=(0,n.useCallback)((t=>e(Rn(t))),[e]),a=(0,n.useCallback)(((t,a)=>e(Nn({address:t,data:a}))),[e]);return(0,h.jsx)(xn,{program:window.luckyWheel.program,name:"lotteryInfo",filter:Bn,init:t,upset:a})},Fn=[],zn=()=>{const e=(0,r.useDispatch)(),t=(0,n.useCallback)((t=>e(Ke(t))),[e]),a=(0,n.useCallback)(((t,a)=>e(Ze({address:t,data:a}))),[e]);return(0,h.jsx)(xn,{program:window.luckyWheel.program,name:"challengeReward",filter:Fn,init:t,upset:a})},Ln="ChallengeReceipt",Mn=(0,f.createAsyncThunk)("ChallengeReceipt/initChallengeReceipts",(async e=>e)),En=(0,f.createAsyncThunk)("ChallengeReceipt/upsetChallengeReceipt",(async e=>{let{address:t,data:a}=e;if(!le.account.isAddress(t))throw new Error("Invalid receipt address");if(!a)throw new Error("Data is empty");return{[t]:a}})),Dn=(0,f.createSlice)({name:Ln,initialState:{},reducers:{},extraReducers:e=>{e.addCase(Mn.fulfilled,((e,t)=>{let{payload:a}=t;return a})).addCase(En.fulfilled,((e,t)=>{let{payload:a}=t;Object.assign(e,a)}))}}).reducer,On=[],Wn=()=>{const e=(0,r.useDispatch)(),t=(0,n.useCallback)((t=>e(Mn(t))),[e]),a=(0,n.useCallback)(((t,a)=>e(En({address:t,data:a}))),[e]);return(0,h.jsx)(xn,{program:window.luckyWheel.program,name:"challengeRewardReceipt",filter:On,init:t,upset:a})},Kn=e=>{let{children:t}=e;const[a,r]=(0,n.useState)(!0);return(0,n.useEffect)((()=>{setTimeout((()=>r(!1)),3e3)}),[]),(0,h.jsxs)(n.Fragment,{children:[(0,h.jsx)(jn,{}),(0,h.jsx)(fn,{}),(0,h.jsx)(An,{}),(0,h.jsx)(In,{}),(0,h.jsx)(zn,{}),(0,h.jsx)(Wn,{}),a?(0,h.jsx)(pn,{}):t]})};a(56373);const Zn=()=>{const{opacity:e,numberOfPieces:t,gravity:a,zIndex:n}=(0,r.useSelector)((e=>e.main.confetti)),{root:c,extend:d}=(0,s.useAppRoute)(),u=M();return(0,h.jsx)(un,{children:(0,h.jsx)(Kn,{children:(0,h.jsx)(dn,{campaignAddress:u,children:(0,h.jsxs)(l.Row,{gutter:[24,24],children:[(0,h.jsx)(o(),{style:{zIndex:n,width:"100%"},gravity:a,opacity:e,numberOfPieces:t}),(0,h.jsx)(l.Col,{span:24,children:(0,h.jsxs)(i.Switch,{children:[(0,h.jsx)(i.Route,{exact:!0,path:d("/admin"),component:wt}),(0,h.jsx)(i.Route,{exact:!0,path:d("/dashboard"),component:on}),(0,h.jsx)(i.Redirect,{from:c,to:`${c}/dashboard`})]})})]})})})})};var _n=a(97429).Buffer;BigInt.prototype.toJSON=function(){return this.toString()};const Hn={serializableCheck:{isSerializable:e=>"undefined"===typeof e||null===e||"string"===typeof e||"boolean"===typeof e||"number"===typeof e||Array.isArray(e)||(e=>{if(null===e)return!1;const t=Object.getPrototypeOf(e);return null!==t&&null===Object.getPrototypeOf(t)})(e)||"bigint"===typeof e||e instanceof d.web3.PublicKey||e instanceof d.BN||_n.isBuffer(e)}},Vn=(0,f.configureStore)({middleware:e=>e(Hn),devTools:!1,reducer:{main:L,campaigns:mn,rewards:pe,tickets:vn,lotteryInfos:Pn,challengeRewards:He,challengeReceipts:Dn}});const Yn=a.p+"static/media/bg-lucky-wheel.9b9f5b320d8e3574f290c88a766abd71.svg";var Gn=a(45597);const{manifest:{appId:Un}}=C,$n=()=>{const e=(0,s.useSetBackground)();return(0,n.useEffect)((()=>{e({dark:Yn,light:Yn})}),[e]),(0,h.jsx)(s.AntdProvider,{appId:Un,prefixCls:Un,children:(0,h.jsx)(r.Provider,{store:Vn,children:(0,h.jsx)(Zn,{})})})}},83272:(e,t,a)=>{"use strict";e.exports=a.p+"static/media/README.b814b85f212785d7efd5.md"},27803:(e,t,a)=>{"use strict";e.exports=a.p+"static/media/panel1.c4dfe48d28d8c4ebce76.png"},85468:(e,t,a)=>{"use strict";e.exports=a.p+"static/media/panel2.a3f21e34a2807fb886e4.png"},83943:(e,t,a)=>{"use strict";e.exports=a.p+"static/media/panel3.b46b51e98165d84bfb4c.png"},7420:()=>{},95856:()=>{},46601:()=>{},89214:()=>{},85568:()=>{},52361:()=>{},94616:()=>{},55024:()=>{}}]);
//# sourceMappingURL=src_bootstrap_app_tsx-src_static_sound_fail_mp3-src_static_sound_sound_mp3-src_static_sound_w-1e4732.27f941ab.chunk.js.map